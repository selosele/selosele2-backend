"use strict";(self["webpackChunkselosele2"]=self["webpackChunkselosele2"]||[]).push([[950],{6597:function(e,t,n){n.d(t,{a:function(){return l}});var a=n(9266),u=n(8822);class i{constructor(){}setPageTitle(e){(0,u.UE)(e)?document.title=`${e} - ${a.Z.state.BlogConfig.data.title}`:document.title=a.Z.state.BlogConfig.data.title}}const l=new i},3950:function(e,t,n){n.r(t),n.d(t,{default:function(){return c}});var a=n(3396);function u(e,t,n,u,i,l){const s=(0,a.up)("ui-skeletor"),r=(0,a.up)("ui-button"),d=(0,a.up)("ui-tree"),o=(0,a.up)("ui-pane"),m=(0,a.up)("ui-loading"),h=(0,a.up)("app-save-menu"),p=(0,a.up)("ui-split-pane"),c=(0,a.up)("app-content-wrapper");return(0,a.wg)(),(0,a.j4)(c,{pageTitle:i.pageTitle},{default:(0,a.w5)((()=>[i.dataLoaded?((0,a.wg)(),(0,a.j4)(p,{key:1},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{isTransparent:!0},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{nodes:i.menuTree,useCheckbox:!1,filter:!0,placeholder:"메뉴명 입력",onOnNodeClick:l.onNodeClick},{btn:(0,a.w5)((()=>[(0,a.Wm)(r,{color:"primary",onClick:l.addMenu},{default:(0,a.w5)((()=>[(0,a.Uk)("추가 ")])),_:1},8,["onClick"])])),_:1},8,["nodes","onOnNodeClick"])])),_:1}),e.isSplitterActive?((0,a.wg)(),(0,a.j4)(o,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{activeModel:!i.dataLoaded2},null,8,["activeModel"]),i.dataLoaded2?((0,a.wg)(),(0,a.j4)(h,{menu:i.menu,parentMenuList:i.parentMenuList,key:i.menu.id,onRefreshMenu:l.refreshTree},null,8,["menu","parentMenuList","onRefreshMenu"])):(0,a.kq)("",!0)])),_:1})):(0,a.kq)("",!0)])),_:1})):((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a.Wm)(s,{height:"1.3rem"},null,8,["height"]),(0,a.Wm)(s,{height:"1.3rem"},null,8,["height"]),(0,a.Wm)(s,{height:"1.3rem"},null,8,["height"])],64))])),_:1},8,["pageTitle"])}function i(e,t,n,u,i,l){const s=(0,a.up)("ui-hidden-field"),r=(0,a.up)("ui-select"),d=(0,a.up)("ui-text-field"),o=(0,a.up)("ui-numeric-field"),m=(0,a.up)("ui-radio"),h=(0,a.up)("ui-radio-group"),p=(0,a.up)("ui-split-form");return(0,a.wg)(),(0,a.j4)(p,{name:"saveMenuForm",btnRemove:!0,onOnsubmit:l.onSubmit,onRemove:l.onRemove},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{name:"id",ref:"menuId",value:n.menu.id},null,8,["value"]),(0,a.Wm)(r,{name:"parentId",id:"menuParentId",title:"부모 메뉴",label:"부모 메뉴",defaultValue:"부모 메뉴 선택",data:n.parentMenuList,modelValue:i.parentId,"onUpdate:modelValue":t[0]||(t[0]=e=>i.parentId=e)},null,8,["data","modelValue"]),(0,a.Wm)(d,{type:"text",name:"name",id:"menuName",label:"메뉴 명",rules:"required",value:n.menu.name},null,8,["value"]),(0,a.Wm)(d,{type:"text",name:"link",id:"menuLink",label:"메뉴 링크",rules:"required",value:n.menu.link},null,8,["value"]),(0,a.Wm)(d,{type:"text",name:"regDate",id:"menuRegDate",label:"메뉴 등록일시",readonly:!0,value:n.menu.regDate},null,8,["value"]),(0,a.Wm)(o,{name:"sort",id:"menuSort",label:"메뉴 정렬 순서",rules:"required",value:n.menu.sort},null,8,["value"]),(0,a.Wm)(r,{name:"role",id:"menuRoles",title:"메뉴 권한",label:"메뉴 권한",rules:"required",defaultValue:"메뉴 권한 선택",data:i.roleList,modelValue:i.role,"onUpdate:modelValue":t[1]||(t[1]=e=>i.role=e)},null,8,["data","modelValue"]),(0,a.Wm)(h,{label:"메뉴 사용 여부"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{id:"menuUseYn1",name:"useYn",label:"사용",value:"Y",rules:"required",modelValue:i.useYn,"onUpdate:modelValue":t[2]||(t[2]=e=>i.useYn=e)},null,8,["modelValue"]),(0,a.Wm)(m,{id:"menuUseYn2",name:"useYn",label:"미사용",value:"N",rules:"required",modelValue:i.useYn,"onUpdate:modelValue":t[3]||(t[3]=e=>i.useYn=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["onOnsubmit","onRemove"])}var l=n(8822),s={name:"app-save-menu",props:{menu:Object,parentMenuList:Array},data(){return{parentId:"",useYn:"",role:"",roleList:[]}},async created(){this.parentId=this.menu.parentId,this.useYn=this.menu.useYn,await this.listRole(),this.role=this.getMenuRoleModel()},methods:{async onSubmit(e){const t=await l.wW.confirmSuccess("저장하시겠습니까?");t&&((0,l.xb)(e.id)?await this.addMenu(e):await this.updateMenu(e),this.listMenu())},async onRemove(e){if((0,l.xb)(e.id))return;const t=await l.wW.confirmSuccess("삭제하시겠습니까?");t&&this.$http.delete(`/menu/${e.id}`).then((e=>{l.wW.toastSuccess("삭제되었습니다."),this.listMenu(),this.$emit("refreshMenu")}))},addMenu(e){return this.$http.post("/menu",e).then((e=>{l.wW.toastSuccess("저장되었습니다."),this.$refs["menuId"].$el.value=e.data.id,this.$emit("refreshMenu")}))},listMenu(){this.$store.dispatch("Menu/LIST_MENU",{client:this.$http,params:{useYn:"Y"}})},updateMenu(e){return this.$http.put("/menu",e).then((e=>{l.wW.toastSuccess("저장되었습니다."),this.$refs["menuId"].$el.value=e.data.id,this.$emit("refreshMenu")}))},listRole(){return this.$http.get("/auth/role").then((e=>{this.roleList=[...e.data.map((e=>({value:e.roleId,text:e.roleNm})))],this.roleList.push({value:"0",text:"모든 권한 허용"})}))},getMenuRoleModel(){if((0,l.UE)(this.menu.menuRole)&&0<this.menu.menuRole.length){const e=this.menu.menuRole.filter((e=>this.roleList.filter((t=>t.value===e.roleId)).length>0));return 1<e.length?"0":e[0].roleId}return""}}},r=n(89);const d=(0,r.Z)(s,[["render",i]]);var o=d,m=n(6597),h={name:"app-admin-menu",components:{AppSaveMenu:o},data(){return{pageTitle:"메뉴 관리",menuTree:[],menu:{},parentMenuList:[],dataLoaded:!1,dataLoaded2:!1}},created(){this.init()},methods:{async init(){m.a.setPageTitle(this.pageTitle),await this.listMenuTree(),this.$store.commit("Splitter/TOGGLE",!0),this.dataLoaded=!0,this.dataLoaded2=!0},listMenuTree(){return this.$http.get("/menu/list/tree").then((e=>{this.createTree(e.data),this.parentMenuList=this.listParentMenu(this.$store.state.Menu.data,[])}))},createTree(e){e.forEach((e=>{let t={id:e.id,label:e.name,nodes:e.children.map(((e,t,n)=>0===n.length?{}:{id:e.id,label:e.name}))};this.menuTree.push(t)}))},async onNodeClick(e){this.$store.commit("Splitter/TOGGLE",!0),e.id!==this.menu?.id&&(this.dataLoaded2=!1,await this.getMenu(e),this.dataLoading2())},async refreshTree(){this.resetMenu(),this.menuTree=[],await this.listMenuTree()},getMenu(e){return this.$http.get(`/menu/${e.id}`).then((e=>{this.menu={...e.data},this.parentMenuList=this.listParentMenu(this.$store.state.Menu.data,[]).filter((e=>e.value!==this.menu.id)),this.menu.regDate=this.$moment(this.menu.regDate).format("YYYY-MM-DD HH:mm:ss")}))},listParentMenu(e,t){return e.map((e=>({value:e.id,text:e.name})))},addMenu(){this.resetMenu()},resetMenu(){this.menu={},this.menu.id=null,this.menu.parentId=0,this.parentMenuList=this.listParentMenu(this.$store.state.Menu.data,[])},dataLoading2(){(0,l.UE)(this.menu)&&0<Object.values(this.menu).length&&(this.dataLoaded2=!0)}}};const p=(0,r.Z)(h,[["render",u]]);var c=p}}]);
//# sourceMappingURL=950.2ed9ada4.js.map