"use strict";(self["webpackChunkselosele2"]=self["webpackChunkselosele2"]||[]).push([[111],{8951:function(e,t,o){o.r(t),o.d(t,{default:function(){return je}});var s=o(3396),i=o(7139),a=o(9242);const n=e=>((0,s.dD)("data-v-8b60416a"),e=e(),(0,s.Cn)(),e),u={class:"guestbook__wrapper"},l={class:"guestbook__write"},r={class:"guestbook__write__inputs"},d={class:"guestbook__write__input-box"},_=n((()=>(0,s._)("label",{for:"addGuestbookAuthor",class:"guestbook__write__label"},"닉네임",-1))),c={class:"guestbook__write__input-box"},p=n((()=>(0,s._)("label",{for:"addGuestbookPw",class:"guestbook__write__label"},"비밀번호",-1))),b={class:"guestbook__write__btns"},m=(0,s.Uk)("저장 "),k={class:"guestbook__depth1"},g=["id"],h=["innerHTML"],w={class:"guestbook__cont__info depth1"},y={class:"guestbook__author"},v=n((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-user-o","aria-hidden":"true"}),(0,s.Uk)(" 글쓴이 : ")],-1))),f={class:"guestbook__reg-date"},x=n((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-time-o","aria-hidden":"true"}),(0,s.Uk)(" 등록일 : ")],-1))),C={key:0,class:"guestbook__mod-date"},D=n((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-time-o","aria-hidden":"true"}),(0,s.Uk)(" 수정일 : ")],-1))),E={class:"reply-cnt"},$={class:"guestbook__toggle"},G={key:0,class:"guestbook__toggle-list"};function R(e,t,o,n,R,W){const S=(0,s.up)("ui-textarea"),L=(0,s.up)("ui-text-field"),M=(0,s.up)("ui-button"),z=(0,s.up)("ui-form"),Y=(0,s.up)("ui-icon-button"),O=(0,s.up)("app-guestbook-reply-list"),I=(0,s.up)("app-add-guestbook-reply"),U=(0,s.up)("app-content-wrapper");return(0,s.wg)(),(0,s.j4)(U,null,{default:(0,s.w5)((()=>[(0,s._)("div",u,[(0,s.Wm)(z,{class:(0,i.C_)("guestbook__write-frm"),name:"addGuestbookForm",onOnsubmit:W.onSubmit},{default:(0,s.w5)((()=>[(0,s._)("div",l,[(0,s.Wm)(S,{name:"cont",id:"addGuestbookCont",clazz:["guestbook__textarea"],title:"방명록 내용 입력",placeholder:"하고싶은 말을 남겨주세요.",cols:"30",rows:"4",rules:"required|max:1000"},null,8,["placeholder"]),(0,s._)("div",r,[(0,s._)("div",d,[_,(0,s.Wm)(L,{type:"text",name:"author",id:"addGuestbookAuthor",clazz:["guestbook__input"],rules:"required|max:20",readonly:e.isLogin,value:e.isLogin?R.adminNickName:""},null,8,["readonly","value"])]),(0,s._)("div",c,[p,(0,s.Wm)(L,{type:"password",name:"authorPw",id:"addGuestbookPw",clazz:["guestbook__input"],rules:"required|min:8|max:15"})]),(0,s._)("div",b,[(0,s.Wm)(M,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--write")},{default:(0,s.w5)((()=>[m])),_:1})])])])])),_:1},8,["onOnsubmit"]),(0,s._)("ul",k,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(R.guestbookList,((t,o)=>((0,s.wg)(),(0,s.iD)("li",{class:"guestbook__depth1__list",id:`guestbook${t.id}`,key:t},[(0,s._)("p",{class:"guestbook__cont",innerHTML:t.cont},null,8,h),(0,s._)("div",w,[(0,s._)("span",y,[v,(0,s._)("span",{class:(0,i.C_)({"font--bold":"Y"===t.adminYn})},(0,i.zw)(t.author),3)]),(0,s._)("span",f,[x,(0,s.Uk)(" "+(0,i.zw)(t.regDate),1)]),t.modDate?((0,s.wg)(),(0,s.iD)("span",C,[D,(0,s.Uk)(" "+(0,i.zw)(t.modDate),1)])):(0,s.kq)("",!0)]),0<t.guestbookReply.length?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Wm)(Y,{icon:"xi-message",title:`댓글 ${t.guestbookReply.length}개 펼쳐보기`,class:(0,i.C_)("guestbook__btn guestbook__btn--reply-open"),onClick:e=>W.toggleReplyList(o)},{default:(0,s.w5)((()=>[(0,s._)("span",E,(0,i.zw)(99<t.guestbookReply.length?"99+":t.guestbookReply.length),1)])),_:2},1032,["title","onClick"]),o===R.replyActiveIndex?((0,s.wg)(),(0,s.j4)(O,{key:t.guestbookReply,list:t.guestbookReply,parentId:t.id,onUpdateReply:W.onUpdateReply},null,8,["list","parentId","onUpdateReply"])):(0,s.kq)("",!0)],64)):(0,s.kq)("",!0),(0,s.Wm)(I,{idx:o,parentId:t.id,onAddReply:W.onAddReply},null,8,["idx","parentId","onAddReply"]),(0,s._)("div",$,[(0,s.Wm)(Y,{icon:"xi-cog",text:"방명록 수정/삭제",title:"방명록 수정/삭제",class:(0,i.C_)("guestbook__btn--toggle"),onClick:(0,a.iM)((e=>W.toggleMenu(o)),["stop"])},null,8,["onClick"]),o===R.activeIndex?((0,s.wg)(),(0,s.iD)("div",G,[(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Wm)(Y,{icon:"xi-pen-o",text:"방명록 수정",showText:!0,class:(0,i.C_)("guestbook__btn--edit1"),ref_for:!0,ref:"guestbookMenuBtn",onClick:o=>W.openModal("E01003",t,e.isLogin)},null,8,["onClick"])]),(0,s._)("li",null,[(0,s.Wm)(Y,{icon:"xi-trash-o",text:"방명록 삭제",showText:!0,class:(0,i.C_)("guestbook__btn--delete1"),ref_for:!0,ref:"guestbookMenuBtn",onClick:o=>W.openModal("E01004",t,e.isLogin)},null,8,["onClick"])])])])):(0,s.kq)("",!0)])],8,g)))),128))])])])),_:1})}var W=o(8822);const S={class:"guestbook__reply__wrapper"},L={class:"guestbook__reply__btns"},M={class:"guestbook__reply__input-box"},z=["for"],Y={class:"guestbook__reply__input-box"},O=["for"],I={class:"guestbook__reply__write__btns"},U=(0,s.Uk)("저장 ");function T(e,t,o,a,n,u){const l=(0,s.up)("ui-hidden-field"),r=(0,s.up)("ui-textarea"),d=(0,s.up)("ui-text-field"),_=(0,s.up)("ui-button"),c=(0,s.up)("ui-form");return(0,s.wg)(),(0,s.iD)("div",S,[(0,s.Wm)(c,{name:`guestbookReplyForm${o.idx}`,onOnsubmit:u.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{name:"parentId",value:o.parentId},null,8,["value"]),(0,s.Wm)(r,{name:"cont",id:`guestbookReplyCont${o.idx}`,clazz:["guestbook__reply__cont","guestbook__textarea"],title:"댓글 입력",placeholder:"댓글을 남겨주세요.",cols:"30",rows:"3",rules:"required|max:1000"},null,8,["id","placeholder"]),(0,s._)("div",L,[(0,s._)("div",M,[(0,s._)("label",{for:`guestbookReplyAuthor${o.idx}`,class:"guestbook__reply__label"},"닉네임",8,z),(0,s.Wm)(d,{type:"text",name:"author",id:`guestbookReplyAuthor${o.idx}`,clazz:["guestbook__input"],rules:"required|max:20",readonly:e.isLogin,value:e.isLogin?n.adminNickName:""},null,8,["id","readonly","value"])]),(0,s._)("div",Y,[(0,s._)("label",{for:`guestbookReplyPw${o.idx}`,class:"guestbook__reply__label"},"비밀번호",8,O),(0,s.Wm)(d,{type:"password",name:"authorPw",id:`guestbookReplyPw${o.idx}`,clazz:["guestbook__input"],rules:"required|min:8|max:15"},null,8,["id"])]),(0,s._)("div",I,[(0,s.Wm)(_,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--reply-write")},{default:(0,s.w5)((()=>[U])),_:1})])])])),_:1},8,["name","onOnsubmit"])])}var A={name:"app-add-guestbook-reply",props:{idx:Number,parentId:Number},data(){return{adminNickName:""}},created(){this.adminNickName=this.$store.state.Guestbook.code.find((e=>"F01001"===e.id)).nm},methods:{async onSubmit(e){const t=await W.wW.confirmSuccess("저장하시겠습니까?");t&&this.$http.post("/guestbookreply",e).then((e=>{W.wW.toastSuccess("저장되었습니다."),this.$emit("addReply",e.data)}))}}},H=o(89);const P=(0,H.Z)(A,[["render",T],["__scopeId","data-v-171d4036"]]);var q=P;const B=e=>((0,s.dD)("data-v-c3a3f384"),e=e(),(0,s.Cn)(),e),F={class:"guestbook__depth2__wrapper"},N={class:"guestbook__depth2__list"},j=["innerHTML"],K={class:"guestbook__cont__info depth2"},Z={class:"guestbook__author"},V=B((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-user-o","aria-hidden":"true"}),(0,s.Uk)(" 글쓴이 : ")],-1))),J={class:"guestbook__reg-date"},Q=B((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-time-o","aria-hidden":"true"}),(0,s.Uk)(" 등록일 : ")],-1))),X={key:0,class:"guestbook__mod-date"},ee=B((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-time-o","aria-hidden":"true"}),(0,s.Uk)(" 수정일 : ")],-1))),te={class:"guestbook__reply__toggle"},oe={key:0,class:"guestbook__reply__toggle-list"};function se(e,t,o,n,u,l){const r=(0,s.up)("ui-icon-button");return(0,s.wg)(),(0,s.iD)("div",F,[(0,s._)("ul",N,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.list.slice(0,u.pageSize),((t,o)=>((0,s.wg)(),(0,s.iD)("li",{class:"guestbook__depth2__item",key:o},[(0,s._)("p",{class:"guestbook__reply__cont",innerHTML:t.cont},null,8,j),(0,s._)("div",K,[(0,s._)("span",Z,[V,(0,s._)("span",{class:(0,i.C_)({"font--bold":"Y"===t.adminYn})},(0,i.zw)(t.author),3)]),(0,s._)("span",J,[Q,(0,s.Uk)(" "+(0,i.zw)(t.regDate),1)]),t.modDate?((0,s.wg)(),(0,s.iD)("span",X,[ee,(0,s.Uk)(" "+(0,i.zw)(t.modDate),1)])):(0,s.kq)("",!0)]),(0,s._)("div",te,[(0,s.Wm)(r,{icon:"xi-cog",text:"방명록 댓글 수정/삭제",title:"방명록 댓글 수정/삭제",class:(0,i.C_)("guestbook__reply__btn--toggle"),onClick:(0,a.iM)((e=>l.toggleMenu(o)),["stop"])},null,8,["onClick"]),o===u.activeIndex?((0,s.wg)(),(0,s.iD)("div",oe,[(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Wm)(r,{icon:"xi-pen-o",text:"댓글 수정",showText:!0,class:(0,i.C_)("guestbook__btn--edit2"),ref_for:!0,ref:"guestbookMenuBtn",onClick:o=>l.openModal("E01003",t,e.isLogin)},null,8,["onClick"])]),(0,s._)("li",null,[(0,s.Wm)(r,{icon:"xi-trash-o",text:"댓글 삭제",showText:!0,class:(0,i.C_)("guestbook__btn--delete2"),ref_for:!0,ref:"guestbookMenuBtn",onClick:o=>l.openModal("E01004",t,e.isLogin)},null,8,["onClick"])])])])):(0,s.kq)("",!0)])])))),128))]),o.list.length>u.pageSize?((0,s.wg)(),(0,s.j4)(r,{key:0,icon:"xi-ellipsis-h",text:"댓글 더보기",class:(0,i.C_)("guestbook__reply-more"),onClick:l.more},null,8,["onClick"])):(0,s.kq)("",!0)])}const ie=e=>((0,s.dD)("data-v-3d05c574"),e=e(),(0,s.Cn)(),e),ae={class:"guestbook__write__inputs"},ne={class:"guestbook__write__input-box"},ue=ie((()=>(0,s._)("label",{for:"updateGuestbookReplyAuthor",class:"guestbook__write__label"},"닉네임",-1))),le={class:"guestbook__write__input-box"},re=ie((()=>(0,s._)("label",{for:"updateGuestbookReplyPw",class:"guestbook__write__label"},"비밀번호",-1))),de={class:"guestbook__write__btns"},_e=(0,s.Uk)("저장 ");function ce(e,t,o,a,n,u){const l=(0,s.up)("ui-hidden-field"),r=(0,s.up)("ui-textarea"),d=(0,s.up)("ui-text-field"),_=(0,s.up)("ui-button"),c=(0,s.up)("ui-form"),p=(0,s.up)("ui-modal");return(0,s.wg)(),(0,s.j4)(p,{title:"방명록 댓글 수정",name:this.$options.name,class:"guestbook-modal__wrapper"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{name:"removeGuestbookReplyForm",onOnsubmit:u.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{name:"id",value:o.guestbookReply.id},null,8,["value"]),(0,s.Wm)(r,{name:"cont",id:"updateGuestbookReplyCont",clazz:["guestbook__textarea"],title:"방명록 내용 입력",placeholder:"하고싶은 말을 남겨주세요.",cols:"30",rows:"4",resize:"vertical",rules:"required|max:1000",value:n.replacedCont},null,8,["placeholder","value"]),(0,s._)("div",ae,[(0,s._)("div",ne,[ue,(0,s.Wm)(d,{type:"text",name:"author",id:"updateGuestbookReplyAuthor",clazz:["guestbook__input"],rules:"required|max:20",readonly:"Y"===o.guestbookReply.adminYn,value:o.guestbookReply.author},null,8,["readonly","value"])]),(0,s._)("div",le,[re,(0,s.Wm)(d,{type:"password",name:"authorPw",id:"updateGuestbookReplyPw",clazz:["guestbook__input"],rules:"required|min:8|max:15"})]),(0,s._)("div",de,[(0,s.Wm)(_,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--write")},{default:(0,s.w5)((()=>[_e])),_:1})])])])),_:1},8,["onOnsubmit"])])),_:1},8,["name"])}var pe={name:"app-update-guestbook-reply-modal",props:{guestbookReply:Object},data(){return{replacedCont:""}},created(){this.replacedCont=this.guestbookReply.cont.replaceAll("<br>","\r\n")},methods:{async onSubmit(e){const t=await W.wW.confirmSuccess("저장하시겠습니까?");t&&this.$http.put("/guestbookreply",e).then((e=>{W.wW.toastSuccess("저장되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Guestbook/FETCH_UPDATED_GUESTBOOK_REPLY",e.data)}))}}};const be=(0,H.Z)(pe,[["render",ce],["__scopeId","data-v-3d05c574"]]);var me=be;const ke={class:"guestbook__write__input-box no-width"},ge={class:"guestbook__write__btns"},he=(0,s.Uk)("삭제 ");function we(e,t,o,a,n,u){const l=(0,s.up)("ui-hidden-field"),r=(0,s.up)("ui-text-field"),d=(0,s.up)("ui-button"),_=(0,s.up)("ui-form"),c=(0,s.up)("ui-modal");return(0,s.wg)(),(0,s.j4)(c,{title:"방명록 댓글 삭제",name:this.$options.name,class:"guestbook-modal__wrapper"},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{name:"removeGuestbookReplyForm",onOnsubmit:u.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{name:"id",value:o.id},null,8,["value"]),(0,s._)("div",ke,[(0,s.Wm)(r,{type:"password",name:"authorPw",id:"removeGuestbookReplyPw",clazz:["guestbook__input"],title:e.isLogin?"관리자는 비밀번호 입력 없이 삭제":"비밀번호 입력",placeholder:"비밀번호 입력",disabled:e.isLogin,rules:e.isLogin?"":"required|min:8|max:15"},null,8,["title","disabled","rules"]),(0,s._)("div",ge,[(0,s.Wm)(d,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--write")},{default:(0,s.w5)((()=>[he])),_:1})])])])),_:1},8,["onOnsubmit"])])),_:1},8,["name"])}var ye={name:"app-remove-guestbook-reply-modal",props:{id:String},methods:{async onSubmit(e){const t=await W.wW.confirmSuccess("삭제하시겠습니까?");t&&this.$http.post("/guestbookreply/remove",e).then((t=>{W.wW.toastSuccess("삭제되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Guestbook/FETCH_REMOVED_GUESTBOOK_REPLY",e)}))}}};const ve=(0,H.Z)(ye,[["render",we],["__scopeId","data-v-451d27a2"]]);var fe=ve,xe={name:"app-guestbook-reply-list",components:{AppUpdateGuestbookReplyModal:me,AppRemoveGuestbookReplyModal:fe},props:{list:Array,parentId:Number},watch:{"$store.state.Guestbook.updatedGuestbookReply"(e){if(0<Object.values(e).length){const{id:t,author:o,cont:s,modDate:i}=e,a=this.list.find((e=>e.id==t));a.author=o,a.cont=s,a.modDate=this.$moment(i).format("YYYY-MM-DD HH:mm:ss"),this.$store.dispatch("Guestbook/FETCH_UPDATED_GUESTBOOK_REPLY",{}),this.$emit("updateReply",a)}},"$store.state.Guestbook.removedGuestbookReply"(e){if(0<Object.values(e).length){const{id:t}=e,o=this.list.findIndex((e=>e.id==t)),s=this.list;s.splice(o,1),this.$store.dispatch("Guestbook/FETCH_REMOVED_GUESTBOOK_REPLY",{})}}},data(){return{pageSize:3,activeIndex:-1}},mounted(){window.document.addEventListener("click",this.closeMenu)},unmounted(){window.document.removeEventListener("click",this.closeMenu)},methods:{more(){this.pageSize+=3},toggleMenu(e){e!==this.activeIndex?this.activeIndex=e:this.activeIndex=-1},closeMenu(e){(0,W.UE)(this.$refs["guestbookMenuBtn"])&&!this.$refs["guestbookMenuBtn"].includes(e.target)&&(this.activeIndex=-1)},openModal(e,t,o){o||"Y"!==t.adminYn?"E01003"===e?this.$modal.show({component:me,bind:{guestbookReply:t}}):"E01004"===e&&this.$modal.show({component:fe,bind:{id:t.id}}):W.wW.toastError("수정/삭제 권한이 없습니다.")}}};const Ce=(0,H.Z)(xe,[["render",se],["__scopeId","data-v-c3a3f384"]]);var De=Ce;const Ee=e=>((0,s.dD)("data-v-3857c6f0"),e=e(),(0,s.Cn)(),e),$e={class:"guestbook__write__inputs"},Ge={class:"guestbook__write__input-box"},Re=Ee((()=>(0,s._)("label",{for:"updateGuestbookAuthor",class:"guestbook__write__label"},"닉네임",-1))),We={class:"guestbook__write__input-box"},Se=Ee((()=>(0,s._)("label",{for:"updateGuestbookPw",class:"guestbook__write__label"},"비밀번호",-1))),Le={class:"guestbook__write__btns"},Me=(0,s.Uk)("저장 ");function ze(e,t,o,a,n,u){const l=(0,s.up)("ui-hidden-field"),r=(0,s.up)("ui-textarea"),d=(0,s.up)("ui-text-field"),_=(0,s.up)("ui-button"),c=(0,s.up)("ui-form"),p=(0,s.up)("ui-modal");return(0,s.wg)(),(0,s.j4)(p,{title:"방명록 수정",name:this.$options.name,class:"guestbook-modal__wrapper"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{name:"removeGuestbookForm",onOnsubmit:u.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{name:"id",value:o.guestbook.id},null,8,["value"]),(0,s.Wm)(r,{name:"cont",id:"updateGuestbookCont",clazz:["guestbook__textarea"],title:"방명록 내용 입력",placeholder:"하고싶은 말을 남겨주세요.",cols:"30",rows:"4",resize:"vertical",rules:"required|max:1000",value:n.replacedCont},null,8,["placeholder","value"]),(0,s._)("div",$e,[(0,s._)("div",Ge,[Re,(0,s.Wm)(d,{type:"text",name:"author",id:"updateGuestbookAuthor",clazz:["guestbook__input"],rules:"required|max:20",readonly:"Y"===o.guestbook.adminYn,value:o.guestbook.author},null,8,["readonly","value"])]),(0,s._)("div",We,[Se,(0,s.Wm)(d,{type:"password",name:"authorPw",id:"updateGuestbookPw",clazz:["guestbook__input"],rules:"required|min:8|max:15"})]),(0,s._)("div",Le,[(0,s.Wm)(_,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--write")},{default:(0,s.w5)((()=>[Me])),_:1})])])])),_:1},8,["onOnsubmit"])])),_:1},8,["name"])}var Ye={name:"app-update-guestbook-modal",props:{guestbook:Object},data(){return{replacedCont:""}},created(){this.replacedCont=this.guestbook.cont.replaceAll("<br>","\r\n")},methods:{async onSubmit(e){const t=await W.wW.confirmSuccess("저장하시겠습니까?");t&&this.$http.put("/guestbook",e).then((e=>{W.wW.toastSuccess("저장되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Guestbook/FETCH_UPDATED_GUESTBOOK",e.data)}))}}};const Oe=(0,H.Z)(Ye,[["render",ze],["__scopeId","data-v-3857c6f0"]]);var Ie=Oe;const Ue={class:"guestbook__write__input-box no-width"},Te={class:"guestbook__write__btns"},Ae=(0,s.Uk)("삭제 ");function He(e,t,o,a,n,u){const l=(0,s.up)("ui-hidden-field"),r=(0,s.up)("ui-text-field"),d=(0,s.up)("ui-button"),_=(0,s.up)("ui-form"),c=(0,s.up)("ui-modal");return(0,s.wg)(),(0,s.j4)(c,{title:"방명록 삭제",name:this.$options.name,class:"guestbook-modal__wrapper"},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{name:"removeGuestbookForm",onOnsubmit:u.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{name:"id",value:o.id},null,8,["value"]),(0,s._)("div",Ue,[(0,s.Wm)(r,{type:"password",name:"authorPw",id:"removeGuestbookPw",clazz:["guestbook__input"],title:e.isLogin?"관리자는 비밀번호 입력 없이 삭제":"비밀번호 입력",placeholder:"비밀번호 입력",disabled:e.isLogin,rules:e.isLogin?"":"required|min:8|max:15"},null,8,["title","disabled","rules"]),(0,s._)("div",Te,[(0,s.Wm)(d,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--write")},{default:(0,s.w5)((()=>[Ae])),_:1})])])])),_:1},8,["onOnsubmit"])])),_:1},8,["name"])}var Pe={name:"app-remove-guestbook-modal",props:{id:String},methods:{async onSubmit(e){const t=await W.wW.confirmSuccess("삭제하시겠습니까?");t&&this.$http.post("/guestbook/remove",e).then((t=>{W.wW.toastSuccess("삭제되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Guestbook/FETCH_REMOVED_GUESTBOOK",e)}))}}};const qe=(0,H.Z)(Pe,[["render",He],["__scopeId","data-v-64c86d2c"]]);var Be=qe,Fe={name:"app-guestbook",components:{AppAddGuestbookReply:q,AppGuestbookReplyList:De},data(){return{page:1,pageSize:6,listCnt:0,guestbookList:[],activeIndex:-1,replyActiveIndex:-1,isScrolled:!1,isLastPage:!1,adminNickName:""}},async created(){this.$store.dispatch("Breadcrumb/FETCH_PAGE_TITLE","방명록"),this.adminNickName=this.$store.state.Guestbook.code.find((e=>"F01001"===e.id)).nm,await this.listGuestbook()},mounted(){window.addEventListener("scroll",this.onScroll),window.document.addEventListener("click",this.closeMenu)},unmounted(){window.removeEventListener("scroll",this.onScroll),window.document.removeEventListener("click",this.closeMenu)},watch:{"$store.state.Guestbook.updatedGuestbook"(e){if(0<Object.values(e).length){const{id:t,author:o,cont:s,modDate:i}=e,a=this.guestbookList.find((e=>e.id==t));a.author=o,a.cont=s,a.cont=this.setData(a).cont,a.modDate=this.$moment(i).format("YYYY-MM-DD HH:mm:ss"),this.$store.dispatch("Guestbook/FETCH_UPDATED_GUESTBOOK",{})}},"$store.state.Guestbook.removedGuestbook"(e){if(0<Object.values(e).length){const{id:t}=e,o=this.guestbookList.findIndex((e=>e.id==t));this.guestbookList.splice(o,1),this.$store.dispatch("Guestbook/FETCH_REMOVED_GUESTBOOK",{})}}},methods:{listGuestbook(){let e={page:this.page,pageSize:this.pageSize};return this.$http.get("/guestbook",{params:e}).then((e=>{0!==e.data[0].length?(e.data[0].forEach((e=>{const t=this.setData(e);this.guestbookList.push(t),e.guestbookReply.forEach((e=>{this.setData(e)}))})),this.listCnt=e.data[1],this.listCnt===this.guestbookList.length&&(this.isLastPage=!0),this.isScrolled=!1):this.isScrolled=!1}))},toggleMenu(e){e!==this.activeIndex?this.activeIndex=e:this.activeIndex=-1},closeMenu(e){(0,W.UE)(this.$refs["guestbookMenuBtn"])&&!this.$refs["guestbookMenuBtn"].includes(e.target)&&(this.activeIndex=-1)},onScroll(){const{scrollY:e}=window,{clientHeight:t,scrollHeight:o}=window.document.documentElement,s=t+e+100>=o;if(s&&!this.isScrolled){if(this.isLastPage)return;setTimeout((()=>{this.isScrolled=!0,this.page++,this.listGuestbook()}),100)}},openModal(e,t,o){o||"Y"!==t.adminYn?"E01003"===e?this.$modal.show({component:Ie,bind:{guestbook:t}}):"E01004"===e&&this.$modal.show({component:Be,bind:{id:t.id}}):W.wW.toastError("수정/삭제 권한이 없습니다.")},toggleReplyList(e){e!==this.replyActiveIndex?this.replyActiveIndex=e:this.replyActiveIndex=-1},async onSubmit(e){const t=await W.wW.confirmSuccess("저장하시겠습니까?");t&&this.$http.post("/guestbook",e).then((e=>{const t={...e.data};t.regDate=this.$moment(t.regDate).format("YYYY-MM-DD HH:mm:ss"),t.guestbookReply=[],this.guestbookList.push(t),this.guestbookList=this.guestbookList.sort(((e,t)=>t.id-e.id)),W.wW.toastSuccess("저장되었습니다.")}))},onAddReply(e){this.guestbookList.forEach((t=>{if(t.id===e.parentId){const o=this.setData(e);t.guestbookReply.push(o)}}))},onUpdateReply(e){e.cont=this.setData(e).cont},setData(e){return e.cont=e.cont.replace(/\r\n|\n/g,"<br>"),e.cont=e.cont.replaceAll("\\r\\n","<br>"),e.regDate=this.$moment(e.regDate).format("YYYY-MM-DD HH:mm:ss"),(0,W.UE)(e.modDate)&&(e.modDate=this.$moment(e.modDate).format("YYYY-MM-DD HH:mm:ss")),e}}};const Ne=(0,H.Z)(Fe,[["render",R],["__scopeId","data-v-8b60416a"]]);var je=Ne}}]);