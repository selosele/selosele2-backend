"use strict";(self["webpackChunkselosele2"]=self["webpackChunkselosele2"]||[]).push([[467],{6597:function(e,t,o){o.d(t,{a:function(){return n}});var s=o(9266),i=o(8822);class a{constructor(){}setPageTitle(e){(0,i.UE)(e)?document.title=`${e} - ${s.Z.state.BlogConfig.data?.title}`:document.title=s.Z.state.BlogConfig.data?.title}}const n=new a},2467:function(e,t,o){o.r(t),o.d(t,{default:function(){return Qe}});var s=o(3396),i=o(7139),a=o(9242);const n=e=>((0,s.dD)("data-v-6188090a"),e=e(),(0,s.Cn)(),e),l={class:"guestbook__wrapper"},u={class:"guestbook__write"},r={class:"guestbook__write__inputs"},d={class:"guestbook__write__input-box"},p=n((()=>(0,s._)("label",{for:"guestbookWriteAuthor",class:"pt--5"},"닉네임",-1))),c={class:"guestbook__write__input-box"},m=n((()=>(0,s._)("label",{for:"guestbookWritePw",class:"pt--5"},"비밀번호",-1))),_={class:"guestbook__write__btns d-flex-w gap--10"},b=(0,s.Uk)("다시작성 "),g=(0,s.Uk)("저장 "),h={key:1,class:"guestbook__depth1"},k=["innerHTML"],y={class:"guestbook__cont__info depth1"},w={class:"guestbook__author"},f=n((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-user-o","aria-hidden":"true"}),(0,s.Uk)(" 글쓴이 : ")],-1))),v={class:"guestbook__reg-date"},x=n((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-time-o","aria-hidden":"true"}),(0,s.Uk)(" 등록일 : ")],-1))),C={key:0,class:"guestbook__mod-date"},D=n((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-time-o","aria-hidden":"true"}),(0,s.Uk)(" 수정일 : ")],-1))),R={class:"reply-cnt"},$={class:"guestbook__toggle"},W={class:"guestbook__toggle-list"},U=["onClick"],S=n((()=>(0,s._)("i",{class:"xi-pen-o","aria-hidden":"true"},null,-1))),L=(0,s.Uk)(" 방명록 수정 "),M=[S,L],E=["onClick"],O=n((()=>(0,s._)("i",{class:"xi-trash-o","aria-hidden":"true"},null,-1))),Y=(0,s.Uk)(" 방명록 삭제 "),G=[O,Y];function T(e,t,o,n,S,L){const O=(0,s.up)("ui-textarea"),Y=(0,s.up)("ui-text-field"),T=(0,s.up)("ui-button"),I=(0,s.up)("ui-form"),A=(0,s.up)("ui-skeletor"),P=(0,s.up)("ui-icon-button"),H=(0,s.up)("app-guestbook-reply-list"),q=(0,s.up)("app-add-guestbook-reply"),B=(0,s.up)("app-content-wrapper");return(0,s.wg)(),(0,s.j4)(B,{pageTitle:S.pageTitle},{default:(0,s.w5)((()=>[(0,s._)("div",l,[(0,s.Wm)(I,{class:(0,i.C_)("guestbook__write-frm"),name:"guestbookForm",onOnsubmit:L.onSubmit},{default:(0,s.w5)((()=>[(0,s._)("div",u,[(0,s.Wm)(O,{name:"cont",id:"guestbookWriteCont",class:(0,i.C_)("guestbook__textarea"),title:"방명록 내용 입력",placeholder:"하고싶은 말을 남겨주세요.",cols:"30",rows:"4",rules:"required"},null,8,["placeholder"]),(0,s._)("div",r,[(0,s._)("div",d,[p,(0,s.Wm)(Y,{type:"text",name:"author",id:"guestbookWriteAuthor",class:(0,i.C_)("guestbook__input"),rules:"required|max:20",readonly:e.isLogin,value:e.isLogin?"관리자":""},null,8,["readonly","value"])]),(0,s._)("div",c,[m,(0,s.Wm)(Y,{type:"password",name:"authorPw",id:"guestbookWritePw",class:(0,i.C_)("guestbook__input"),rules:"required|min:8|max:15"})]),(0,s._)("div",_,[(0,s.Wm)(T,{type:"reset",color:"secondary",class:(0,i.C_)("guestbook__btn guestbook__btn--reset")},{default:(0,s.w5)((()=>[b])),_:1}),(0,s.Wm)(T,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--write")},{default:(0,s.w5)((()=>[g])),_:1})])])])])),_:1},8,["onOnsubmit"]),S.dataLoaded?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Wm)(A,{height:"1.3rem"},null,8,["height"]),(0,s.Wm)(A,{height:"1.3rem"},null,8,["height"]),(0,s.Wm)(A,{height:"1.3rem"},null,8,["height"])],64)),S.dataLoaded?((0,s.wg)(),(0,s.iD)("ul",h,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(S.guestbookList,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{class:"guestbook__depth1__list",key:t},[(0,s._)("p",{class:"guestbook__cont",innerHTML:e.cont},null,8,k),(0,s._)("div",y,[(0,s._)("span",w,[f,(0,s._)("span",{class:(0,i.C_)({"font--bold":"Y"===e.adminYn})},(0,i.zw)(e.author),3)]),(0,s._)("span",v,[x,(0,s.Uk)(" "+(0,i.zw)(e.regDate),1)]),e.modDate?((0,s.wg)(),(0,s.iD)("span",C,[D,(0,s.Uk)(" "+(0,i.zw)(e.modDate),1)])):(0,s.kq)("",!0)]),0<e.guestbookReply.length?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Wm)(P,{type:"button",icon:"xi-message",class:(0,i.C_)("guestbook__btn guestbook__btn--reply-open"),title:`댓글 ${e.guestbookReply.length}개 펼쳐보기`,onClick:e=>L.toggleReplyList(t)},{default:(0,s.w5)((()=>[(0,s._)("span",R,(0,i.zw)(99<e.guestbookReply.length?"99+":e.guestbookReply.length),1)])),_:2},1032,["title","onClick"]),t===S.replyActiveIndex?((0,s.wg)(),(0,s.j4)(H,{key:e.guestbookReply,list:e.guestbookReply,parentId:e.id,onUpdateReply:L.onUpdateReply},null,8,["list","parentId","onUpdateReply"])):(0,s.kq)("",!0)],64)):(0,s.kq)("",!0),(0,s.Wm)(q,{idx:t,parentId:e.id,onAddReply:L.onAddReply},null,8,["idx","parentId","onAddReply"]),(0,s._)("div",$,[(0,s.Wm)(P,{type:"button",icon:"xi-cog",text:"방명록 수정/삭제",class:(0,i.C_)("guestbook__btn--toggle"),onClick:(0,a.iM)((e=>L.toggleMenu(t)),["stop"])},null,8,["onClick"]),(0,s.wy)((0,s._)("div",W,[(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("button",{type:"button",class:"guestbook__btn--edit1",ref_for:!0,ref:"guestbookMenuBtn",onClick:t=>L.openModal("update",e)},M,8,U)]),(0,s._)("li",null,[(0,s._)("button",{type:"button",class:"guestbook__btn--delete1",ref_for:!0,ref:"guestbookMenuBtn",onClick:t=>L.openModal("remove",e)},G,8,E)])])],512),[[a.F8,t===S.activeIndex]])])])))),128))])):(0,s.kq)("",!0)])])),_:1},8,["pageTitle"])}var I=o(8822),A=o(6597);const P={class:"guestbook__reply__wrapper"},H={class:"guestbook__reply__btns"},q={class:"guestbook__reply__btns-inner"},B=["for"],z=["for"],F=(0,s.Uk)("저장 ");function j(e,t,o,a,n,l){const u=(0,s.up)("ui-hidden-field"),r=(0,s.up)("ui-textarea"),d=(0,s.up)("ui-text-field"),p=(0,s.up)("ui-button"),c=(0,s.up)("ui-form");return(0,s.wg)(),(0,s.iD)("div",P,[(0,s.Wm)(c,{name:`guestbookReplyForm${o.idx}`,onOnsubmit:l.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{name:"parentId",value:o.parentId},null,8,["value"]),(0,s.Wm)(r,{name:"cont",id:`guestbookReplyCont${o.idx}`,class:(0,i.C_)("guestbook__reply__cont guestbook__textarea"),title:"댓글 입력",placeholder:"댓글을 남겨주세요.",cols:"30",rows:"3",rules:"required"},null,8,["id","placeholder"]),(0,s._)("div",H,[(0,s._)("div",q,[(0,s._)("label",{for:`guestbookReplyAuthor${o.idx}`,class:"pt--5"},"닉네임",8,B),(0,s.Wm)(d,{type:"text",name:"author",id:`guestbookReplyAuthor${o.idx}`,class:(0,i.C_)("guestbook__input"),rules:"required|max:20",readonly:e.isLogin,value:e.isLogin?"관리자":""},null,8,["id","readonly","value"]),(0,s._)("label",{for:`guestbookReplyPw${o.idx}`,class:"pt--5"},"비밀번호",8,z),(0,s.Wm)(d,{type:"password",name:"authorPw",id:`guestbookReplyPw${o.idx}`,class:(0,i.C_)("guestbook__input"),rules:"required|min:8|max:15"},null,8,["id"])]),(0,s.Wm)(p,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--reply-write")},{default:(0,s.w5)((()=>[F])),_:1})])])),_:1},8,["name","onOnsubmit"])])}var K={name:"app-add-guestbook-reply",props:{idx:Number,parentId:Number},methods:{async onSubmit(e){const t=await I.wW.confirmSuccess("저장하시겠습니까?");t&&this.$http.post("/guestbookreply",e).then((e=>{I.wW.toastSuccess("저장되었습니다."),this.$emit("addReply",e.data)}))}}},Z=o(89);const V=(0,Z.Z)(K,[["render",j],["__scopeId","data-v-307597ec"]]);var N=V;const J=e=>((0,s.dD)("data-v-1a7ba9d2"),e=e(),(0,s.Cn)(),e),Q={class:"guestbook__depth2__wrapper"},X={class:"guestbook__depth2__list"},ee=["innerHTML"],te={class:"guestbook__cont__info depth2"},oe={class:"guestbook__author"},se=J((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-user-o","aria-hidden":"true"}),(0,s.Uk)(" 글쓴이 : ")],-1))),ie={class:"guestbook__reg-date"},ae=J((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-time-o","aria-hidden":"true"}),(0,s.Uk)(" 등록일 : ")],-1))),ne={key:0,class:"guestbook__mod-date"},le=J((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-time-o","aria-hidden":"true"}),(0,s.Uk)(" 수정일 : ")],-1))),ue={class:"guestbook__reply__toggle"},re={class:"guestbook__reply__toggle-list"},de=["onClick"],pe=J((()=>(0,s._)("i",{class:"xi-pen-o","aria-hidden":"true"},null,-1))),ce=(0,s.Uk)(" 댓글 수정 "),me=[pe,ce],_e=["onClick"],be=J((()=>(0,s._)("i",{class:"xi-trash-o","aria-hidden":"true"},null,-1))),ge=(0,s.Uk)(" 댓글 삭제 "),he=[be,ge];function ke(e,t,o,n,l,u){const r=(0,s.up)("ui-icon-button");return(0,s.wg)(),(0,s.iD)("div",Q,[(0,s._)("ul",X,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.list.slice(0,l.pageSize),((e,t)=>((0,s.wg)(),(0,s.iD)("li",{class:"guestbook__depth2__item",key:t},[(0,s._)("p",{class:"guestbook__reply__cont",innerHTML:e.cont},null,8,ee),(0,s._)("div",te,[(0,s._)("span",oe,[se,(0,s._)("span",{class:(0,i.C_)({"font--bold":"Y"===e.adminYn})},(0,i.zw)(e.author),3)]),(0,s._)("span",ie,[ae,(0,s.Uk)(" "+(0,i.zw)(e.regDate),1)]),e.modDate?((0,s.wg)(),(0,s.iD)("span",ne,[le,(0,s.Uk)(" "+(0,i.zw)(e.modDate),1)])):(0,s.kq)("",!0)]),(0,s._)("div",ue,[(0,s.Wm)(r,{type:"button",icon:"xi-cog",text:"방명록 댓글 수정/삭제",class:(0,i.C_)("guestbook__reply__btn--toggle"),onClick:(0,a.iM)((e=>u.toggleMenu(t)),["stop"])},null,8,["onClick"]),(0,s.wy)((0,s._)("div",re,[(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("button",{type:"button",class:"guestbook__btn--edit2",ref_for:!0,ref:"guestbookMenuBtn",onClick:t=>u.openModal("update",e)},me,8,de)]),(0,s._)("li",null,[(0,s._)("button",{type:"button",class:"guestbook__btn--delete2",ref_for:!0,ref:"guestbookMenuBtn",onClick:t=>u.openModal("remove",e)},he,8,_e)])])],512),[[a.F8,t===l.activeIndex]])])])))),128))]),o.list.length>l.pageSize?((0,s.wg)(),(0,s.j4)(r,{key:0,type:"button",icon:"xi-ellipsis-h",text:"댓글 더보기",class:(0,i.C_)("guestbook__reply-more"),onClick:u.more},null,8,["onClick"])):(0,s.kq)("",!0)])}const ye={class:"d-flex-w gap--15 mt--20"},we=(0,s._)("label",{for:"guestbookReplyUpdateAuthor",class:"pt--5"},"닉네임",-1),fe=(0,s._)("label",{for:"guestbookReplyUpdatePw",class:"pt--5"},"비밀번호",-1),ve=(0,s.Uk)("수정 ");function xe(e,t,o,a,n,l){const u=(0,s.up)("ui-hidden-field"),r=(0,s.up)("ui-textarea"),d=(0,s.up)("ui-text-field"),p=(0,s.up)("ui-button"),c=(0,s.up)("ui-form"),m=(0,s.up)("ui-modal");return(0,s.wg)(),(0,s.j4)(m,{title:"방명록 댓글 수정",name:this.$options.name},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{name:"removeGuestbookReplyForm",onOnsubmit:l.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{name:"id",value:o.guestbookReply.id},null,8,["value"]),(0,s.Wm)(r,{name:"cont",id:"guestbookReplyUpdateCont",title:"방명록 내용 입력",placeholder:"하고싶은 말을 남겨주세요.",cols:"30",rows:"4",resize:"vertical",rules:"required",value:n.replacedCont},null,8,["placeholder","value"]),(0,s._)("div",ye,[we,(0,s.Wm)(d,{type:"text",name:"author",id:"guestbookReplyUpdateAuthor",class:(0,i.C_)("guestbook__input"),rules:"required|max:20",readonly:"Y"===o.guestbookReply.adminYn,value:o.guestbookReply.author},null,8,["readonly","value"]),fe,(0,s.Wm)(d,{type:"password",name:"authorPw",id:"guestbookReplyUpdatePw",class:(0,i.C_)("guestbook__input"),rules:"required|min:8|max:15"}),(0,s.Wm)(p,{type:"submit",color:"primary"},{default:(0,s.w5)((()=>[ve])),_:1})])])),_:1},8,["onOnsubmit"])])),_:1},8,["name"])}var Ce={name:"app-update-guestbook-reply-modal",props:{guestbookReply:Object},data(){return{replacedCont:""}},created(){this.replacedCont=this.guestbookReply.cont.replaceAll("<br>","\r\n")},methods:{async onSubmit(e){const t=await I.wW.confirmSuccess("저장하시겠습니까?");t&&this.$http.put("/guestbookreply",e).then((e=>{I.wW.toastSuccess("저장되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Guestbook/FETCH_UPDATED_GUESTBOOK_REPLY",e.data)}))}}};const De=(0,Z.Z)(Ce,[["render",xe]]);var Re=De;const $e={class:"d-flex-w gap--10"},We=(0,s.Uk)("삭제 ");function Ue(e,t,o,i,a,n){const l=(0,s.up)("ui-hidden-field"),u=(0,s.up)("ui-text-field"),r=(0,s.up)("ui-button"),d=(0,s.up)("ui-form"),p=(0,s.up)("ui-modal");return(0,s.wg)(),(0,s.j4)(p,{title:"방명록 댓글 삭제",name:this.$options.name},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{name:"removeGuestbookReplyForm",onOnsubmit:n.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{name:"id",value:o.id},null,8,["value"]),(0,s._)("div",$e,[(0,s.Wm)(u,{type:"password",name:"authorPw",id:"guestbookReplyRemovePw",title:"비밀번호 입력",placeholder:"비밀번호 입력",readonly:e.isLogin,rules:e.isLogin?"":"required|min:8|max:15"},null,8,["readonly","rules"]),(0,s.Wm)(r,{type:"submit",color:"primary"},{default:(0,s.w5)((()=>[We])),_:1})])])),_:1},8,["onOnsubmit"])])),_:1},8,["name"])}var Se={name:"app-remove-guestbook-reply-modal",props:{id:String},methods:{async onSubmit(e){const t=await I.wW.confirmSuccess("삭제하시겠습니까?");t&&this.$http.delete(`/guestbookreply/${e.id}`,{data:e}).then((t=>{I.wW.toastSuccess("삭제되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Guestbook/FETCH_REMOVED_GUESTBOOK_REPLY",e)}))}}};const Le=(0,Z.Z)(Se,[["render",Ue]]);var Me=Le,Ee={name:"app-guestbook-reply-list",components:{AppUpdateGuestbookReplyModal:Re,AppRemoveGuestbookReplyModal:Me},props:{list:Array,parentId:Number},watch:{"$store.state.Guestbook.updatedGuestbookReply"(e){if(0<Object.values(e).length){const{id:t,author:o,cont:s,modDate:i}=e,a=this.list.find((e=>e.id==t));a.author=o,a.cont=s,a.modDate=this.$moment(i).format("YYYY-MM-DD HH:mm:ss"),this.$store.dispatch("Guestbook/FETCH_UPDATED_GUESTBOOK_REPLY",{}),this.$emit("updateReply",a)}},"$store.state.Guestbook.removedGuestbookReply"(e){if(0<Object.values(e).length){const{id:t}=e,o=this.list.findIndex((e=>e.id==t)),s=this.list;s.splice(o,1),this.$store.dispatch("Guestbook/FETCH_REMOVED_GUESTBOOK_REPLY",{})}}},data(){return{pageSize:3,activeIndex:-1}},mounted(){document.addEventListener("click",this.closeMenu)},unmounted(){document.removeEventListener("click",this.closeMenu)},methods:{more(){this.pageSize+=3},toggleMenu(e){e!==this.activeIndex?this.activeIndex=e:this.activeIndex=-1},closeMenu(e){(0,I.UE)(this.$refs["guestbookMenuBtn"])&&!this.$refs["guestbookMenuBtn"].includes(e.target)&&(this.activeIndex=-1)},openModal(e,t){"update"===e?this.$modal.show({component:Re,bind:{guestbookReply:t}}):"remove"===e&&this.$modal.show({component:Me,bind:{id:t.id}})}}};const Oe=(0,Z.Z)(Ee,[["render",ke],["__scopeId","data-v-1a7ba9d2"]]);var Ye=Oe;const Ge={class:"d-flex-w gap--15 mt--20"},Te=(0,s._)("label",{for:"guestbookUpdateAuthor",class:"pt--5"},"닉네임",-1),Ie=(0,s._)("label",{for:"guestbookUpdatePw",class:"pt--5"},"비밀번호",-1),Ae=(0,s.Uk)("수정 ");function Pe(e,t,o,a,n,l){const u=(0,s.up)("ui-hidden-field"),r=(0,s.up)("ui-textarea"),d=(0,s.up)("ui-text-field"),p=(0,s.up)("ui-button"),c=(0,s.up)("ui-form"),m=(0,s.up)("ui-modal");return(0,s.wg)(),(0,s.j4)(m,{title:"방명록 수정",name:this.$options.name},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{name:"removeGuestbookForm",onOnsubmit:l.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{name:"id",value:o.guestbook.id},null,8,["value"]),(0,s.Wm)(r,{name:"cont",id:"guestbookUpdateCont",title:"방명록 내용 입력",placeholder:"하고싶은 말을 남겨주세요.",cols:"30",rows:"4",resize:"vertical",rules:"required",value:n.replacedCont},null,8,["placeholder","value"]),(0,s._)("div",Ge,[Te,(0,s.Wm)(d,{type:"text",name:"author",id:"guestbookUpdateAuthor",class:(0,i.C_)("guestbook__input"),rules:"required|max:20",readonly:"Y"===o.guestbook.adminYn,value:o.guestbook.author},null,8,["readonly","value"]),Ie,(0,s.Wm)(d,{type:"password",name:"authorPw",id:"guestbookUpdatePw",class:(0,i.C_)("guestbook__input"),rules:"required|min:8|max:15"}),(0,s.Wm)(p,{type:"submit",color:"primary"},{default:(0,s.w5)((()=>[Ae])),_:1})])])),_:1},8,["onOnsubmit"])])),_:1},8,["name"])}var He={name:"app-update-guestbook-modal",props:{guestbook:Object},data(){return{replacedCont:""}},created(){this.replacedCont=this.guestbook.cont.replaceAll("<br>","\r\n")},methods:{async onSubmit(e){const t=await I.wW.confirmSuccess("저장하시겠습니까?");t&&this.$http.put("/guestbook",e).then((e=>{I.wW.toastSuccess("저장되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Guestbook/FETCH_UPDATED_GUESTBOOK",e.data)}))}}};const qe=(0,Z.Z)(He,[["render",Pe]]);var Be=qe;const ze={class:"d-flex-w gap--10"},Fe=(0,s.Uk)("삭제 ");function je(e,t,o,i,a,n){const l=(0,s.up)("ui-hidden-field"),u=(0,s.up)("ui-text-field"),r=(0,s.up)("ui-button"),d=(0,s.up)("ui-form"),p=(0,s.up)("ui-modal");return(0,s.wg)(),(0,s.j4)(p,{title:"방명록 삭제",name:this.$options.name},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{name:"removeGuestbookForm",onOnsubmit:n.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{name:"id",value:o.id},null,8,["value"]),(0,s._)("div",ze,[(0,s.Wm)(u,{type:"password",name:"authorPw",id:"guestbookRemovePw",title:"비밀번호 입력",placeholder:"비밀번호 입력",readonly:e.isLogin,rules:e.isLogin?"":"required|min:8|max:15"},null,8,["readonly","rules"]),(0,s.Wm)(r,{type:"submit",color:"primary"},{default:(0,s.w5)((()=>[Fe])),_:1})])])),_:1},8,["onOnsubmit"])])),_:1},8,["name"])}var Ke={name:"app-remove-guestbook-modal",props:{id:String},methods:{async onSubmit(e){const t=await I.wW.confirmSuccess("삭제하시겠습니까?");t&&this.$http.delete(`/guestbook/${e.id}`,{data:e}).then((t=>{I.wW.toastSuccess("삭제되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Guestbook/FETCH_REMOVED_GUESTBOOK",e)}))}}};const Ze=(0,Z.Z)(Ke,[["render",je]]);var Ve=Ze,Ne={name:"app-guestbook",components:{AppAddGuestbookReply:N,AppGuestbookReplyList:Ye},data(){return{pageTitle:"방명록",page:1,pageSize:6,listCnt:0,guestbookList:[],activeIndex:-1,replyActiveIndex:-1,isScrolled:!1,isLastPage:!1,dataLoaded:!1}},async created(){A.a.setPageTitle(this.pageTitle),await this.listGuestbook(),this.dataLoading()},mounted(){window.addEventListener("scroll",this.onScroll),document.addEventListener("click",this.closeMenu)},unmounted(){window.removeEventListener("scroll",this.onScroll),document.removeEventListener("click",this.closeMenu)},watch:{"$store.state.Guestbook.updatedGuestbook"(e){if(0<Object.values(e).length){const{id:t,author:o,cont:s,modDate:i}=e,a=this.guestbookList.find((e=>e.id==t));a.author=o,a.cont=s,a.cont=this.setData(a).cont,a.modDate=this.$moment(i).format("YYYY-MM-DD HH:mm:ss"),this.$store.dispatch("Guestbook/FETCH_UPDATED_GUESTBOOK",{})}},"$store.state.Guestbook.removedGuestbook"(e){if(0<Object.values(e).length){const{id:t}=e,o=this.guestbookList.findIndex((e=>e.id==t));this.guestbookList.splice(o,1),this.$store.dispatch("Guestbook/FETCH_REMOVED_GUESTBOOK",{})}}},methods:{listGuestbook(){let e={page:this.page,pageSize:this.pageSize};return this.$http.get("/guestbook",{params:e}).then((e=>{0!==e.data[0].length?(e.data[0].map((e=>{const t=this.setData(e);this.guestbookList.push(t),e.guestbookReply.map((e=>{this.setData(e)}))})),this.listCnt=e.data[1],this.listCnt===this.guestbookList.length&&(this.isLastPage=!0),this.isScrolled=!1):this.isScrolled=!1}))},toggleMenu(e){e!==this.activeIndex?this.activeIndex=e:this.activeIndex=-1},closeMenu(e){(0,I.UE)(this.$refs["guestbookMenuBtn"])&&!this.$refs["guestbookMenuBtn"].includes(e.target)&&(this.activeIndex=-1)},onScroll(){const{scrollY:e}=window,{clientHeight:t,scrollHeight:o}=document.documentElement,s=t+e+100>=o;if(s&&!this.isScrolled){if(this.isLastPage)return;setTimeout((()=>{this.isScrolled=!0,this.page++,this.listGuestbook()}),100)}},openModal(e,t){"update"===e?this.$modal.show({component:Be,bind:{guestbook:t}}):"remove"===e&&this.$modal.show({component:Ve,bind:{id:t.id}})},toggleReplyList(e){e!==this.replyActiveIndex?this.replyActiveIndex=e:this.replyActiveIndex=-1},async onSubmit(e){const t=await I.wW.confirmSuccess("저장하시겠습니까?");t&&this.$http.post("/guestbook",e).then((e=>{const t={...e.data};t.regDate=this.$moment(t.regDate).format("YYYY-MM-DD HH:mm:ss"),this.guestbookList.push(t),this.guestbookList=this.guestbookList.sort(((e,t)=>t.id-e.id)),I.wW.toastSuccess("저장되었습니다.")}))},async onAddReply(e){this.guestbookList=this.guestbookList.map((t=>{if(t.id===e.parentId){const o=this.setData(e);t.guestbookReply.push(o)}return t}))},onUpdateReply(e){e.cont=this.setData(e).cont},setData(e){return e.cont=e.cont.replace(/\r\n|\n/g,"<br>"),e.cont=e.cont.replaceAll("\\r\\n","<br>"),e.regDate=this.$moment(e.regDate).format("YYYY-MM-DD HH:mm:ss"),(0,I.UE)(e.modDate)&&(e.modDate=this.$moment(e.modDate).format("YYYY-MM-DD HH:mm:ss")),e},dataLoading(){0<this.guestbookList.length&&(this.dataLoaded=!0)}}};const Je=(0,Z.Z)(Ne,[["render",T],["__scopeId","data-v-6188090a"]]);var Qe=Je}}]);
//# sourceMappingURL=467.6a35892c.js.map