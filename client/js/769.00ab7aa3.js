"use strict";(self["webpackChunkselosele2"]=self["webpackChunkselosele2"]||[]).push([[769],{6597:function(e,t,o){var s=o(4460),i=o(4722);class l{constructor(){}setPageTitle(e){(0,i.UE)(e)?document.title=`${e} - ${s.Z.state.blogConfig.title}`:document.title=s.Z.state.blogConfig.title}}const n=new l;t["Z"]=n},3769:function(e,t,o){o.r(t),o.d(t,{default:function(){return ke}});var s=o(3396),i=o(7139),l=o(9242);const n=e=>((0,s.dD)("data-v-7f637328"),e=e(),(0,s.Cn)(),e),a={class:"guestbook__wrapper"},r={class:"guestbook__write"},u={class:"guestbook__write__inputs"},d={for:"writeAuthor"},c=(0,s.Uk)("닉네임 "),g={for:"writePw"},_=(0,s.Uk)("비밀번호 "),p={class:"guestbook__write__btns d-flex-w gap--10"},m=(0,s.Uk)("다시작성 "),h=(0,s.Uk)("등록 "),b={key:1,class:"guestbook__depth1"},k=["innerHTML"],w={class:"guestbook__cont__info depth1"},f={class:"guestbook__author"},y=n((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-user-o","aria-hidden":"true"}),(0,s.Uk)(" 글쓴이 : ")],-1))),v={class:"guestbook__reg-date"},L=n((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-time-o","aria-hidden":"true"}),(0,s.Uk)(" 등록일 : ")],-1))),x=["title"],S=n((()=>(0,s._)("i",{class:"xi-message","aria-hidden":"true"},null,-1))),C={class:"reply_cnt"},M=n((()=>(0,s._)("div",{class:"guestbook__depth2"},[(0,s._)("ul")],-1))),U={class:"guestbook__reply__wrapper"},$={class:"guestbook__reply__btns"},D={class:"guestbook__reply__btns-inner"},W=["for"],Y=(0,s.Uk)("닉네임 "),Z=["for"],H=(0,s.Uk)("비밀번호 "),P=(0,s.Uk)("등록 "),T={class:"guestbook__reply__toggle"},E=["onClick"],q=n((()=>(0,s._)("i",{class:"xi-cog","aria-hidden":"true"},null,-1))),F=n((()=>(0,s._)("span",{class:"sr-only"},"방명록 수정/삭제",-1))),I=[q,F],z={class:"guestbook__reply__toggle-list"},G=["onClick"],R=n((()=>(0,s._)("i",{class:"xi-pen-o","aria-hidden":"true"},null,-1))),A=(0,s.Uk)(" 방명록 수정 "),B=[R,A],O=["onClick"],V=n((()=>(0,s._)("i",{class:"xi-trash-o","aria-hidden":"true"},null,-1))),j=(0,s.Uk)(" 방명록 삭제 "),K=[V,j];function N(e,t,o,n,q,F){const R=(0,s.up)("ui-textarea"),A=(0,s.up)("ui-text-field"),V=(0,s.up)("ui-button"),j=(0,s.up)("ui-form"),N=(0,s.up)("ui-skeletor"),J=(0,s.up)("app-content-wrapper");return(0,s.wg)(),(0,s.j4)(J,{pageTitle:q.pageTitle},{default:(0,s.w5)((()=>[(0,s._)("div",a,[(0,s.Wm)(j,{class:(0,i.C_)("guestbook__write-frm"),name:"guestbookForm",onOnSubmit:F.onSubmit},{default:(0,s.w5)((()=>[(0,s._)("div",r,[(0,s.Wm)(R,{name:"cont",id:"guestbookWriteCont",title:"방명록 내용 입력",placeholder:"하고싶은 말을 남겨주세요.",cols:"30",rows:"4",rules:"required"},null,8,["placeholder"]),(0,s._)("div",u,[(0,s._)("label",d,[c,(0,s.Wm)(A,{type:"text",name:"author",id:"writeAuthor",class:(0,i.C_)("guestbook__input"),rules:"required|maxLength:20"})]),(0,s._)("label",g,[_,(0,s.Wm)(A,{type:"password",name:"authorPw",id:"writePw",class:(0,i.C_)("guestbook__input"),rules:"required|minLength:8|maxLength:15"})]),(0,s._)("div",p,[(0,s.Wm)(V,{type:"reset",color:"secondary",class:(0,i.C_)("guestbook__btn guestbook__btn--reset")},{default:(0,s.w5)((()=>[m])),_:1}),(0,s.Wm)(V,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--write")},{default:(0,s.w5)((()=>[h])),_:1})])])])])),_:1},8,["onOnSubmit"]),q.dataLoaded?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Wm)(N,{height:"1.3rem"},null,8,["height"]),(0,s.Wm)(N,{height:"1.3rem"},null,8,["height"]),(0,s.Wm)(N,{height:"1.3rem"},null,8,["height"])],64)),q.dataLoaded?((0,s.wg)(),(0,s.iD)("ul",b,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(q.guestbookList,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{class:"guestbook__depth1__list",key:t},[(0,s._)("p",{class:"guestbook__cont",innerHTML:e.cont},null,8,k),(0,s._)("div",w,[(0,s._)("span",f,[y,(0,s.Uk)(" "+(0,i.zw)(e.author),1)]),(0,s._)("span",v,[L,(0,s.Uk)(" "+(0,i.zw)(e.regDate),1)])]),0<e.guestbookReply.length?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("button",{type:"button",class:"guestbook__btn guestbook__btn--reply-open",title:`댓글 ${e.guestbookReply.length}개 펼쳐보기`},[S,(0,s._)("span",C,(0,i.zw)(e.guestbookReply.length>99?"99+":e.guestbookReply.length),1)],8,x),M],64)):(0,s.kq)("",!0),(0,s._)("div",U,[(0,s.Wm)(j,{name:"guestbookReplyForm"},{default:(0,s.w5)((()=>[(0,s.Wm)(R,{name:"cont",id:`replyCont${t}`,class:(0,i.C_)("guestbook__reply__cont"),title:"댓글 입력",placeholder:"댓글을 남겨주세요.",cols:"30",rows:"3",rules:"required"},null,8,["id","placeholder"]),(0,s._)("div",$,[(0,s._)("div",D,[(0,s._)("label",{for:`replyAuthor${t}`},[Y,(0,s.Wm)(A,{type:"text",name:"author",id:`replyAuthor${t}`,class:(0,i.C_)("guestbook__input"),rules:"required|maxLength:20"},null,8,["id"])],8,W),(0,s._)("label",{for:`replyPw${t}`},[H,(0,s.Wm)(A,{type:"password",name:"authorPw",id:`replyPw${t}`,class:(0,i.C_)("guestbook__input"),rules:"required|minLength:8|maxLength:15"},null,8,["id"])],8,Z)]),(0,s.Wm)(V,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--reply-write")},{default:(0,s.w5)((()=>[P])),_:1})])])),_:2},1024)]),(0,s._)("div",T,[(0,s._)("button",{type:"button",class:"guestbook__reply__btn--toggle",onClick:e=>F.toggleMenu(t)},I,8,E),(0,s.wy)((0,s._)("div",z,[(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("button",{type:"button",class:"guestbook__btn--edit1",ref_for:!0,ref:"guestbookMenuBtn",onClick:t=>F.openModal("update",e.id)},B,8,G)]),(0,s._)("li",null,[(0,s._)("button",{type:"button",class:"guestbook__btn--delete1",ref_for:!0,ref:"guestbookMenuBtn",onClick:t=>F.openModal("remove",e.id)},K,8,O)])])],512),[[l.F8,t===q.activeIndex]])])])))),128))])):(0,s.kq)("",!0)])])),_:1},8,["pageTitle"])}var J=o(3366),Q=o(952);function X(e,t,o,i,l,n){const a=(0,s.up)("Field"),r=(0,s.up)("ErrorMessage");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(a,(0,s.dG)({as:"textarea",id:o.id,ref:o.id,name:o.name,title:o.title,placeholder:o.placeholder,cols:o.cols,rows:o.rows,rules:o.rules,value:o.modelValue},e.$attrs,{onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value))}),null,16,["id","name","title","placeholder","cols","rows","rules","value"]),(0,s.Wm)(r,{class:"form-field-error",name:o.name},null,8,["name"])],64)}var ee=o(5708),te={name:"ui-textarea",components:{Field:ee.gN,ErrorMessage:ee.Bc},props:{id:String,name:String,title:String,placeholder:String,cols:String,rows:String,rules:String,modelValue:String}},oe=o(89);const se=(0,oe.Z)(te,[["render",X]]);var ie=se,le=o(3210),ne=o(1197),ae=o(6597),re=o(4722);const ue=["value"],de={class:"d-flex-w gap--10"},ce=(0,s.Uk)("삭제 ");function ge(e,t,o,i,l,n){const a=(0,s.up)("ui-text-field"),r=(0,s.up)("ui-button"),u=(0,s.up)("ui-form"),d=(0,s.up)("ui-modal");return(0,s.wg)(),(0,s.j4)(d,{title:"방명록 삭제",name:this.$options.name},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{name:"removeGuestbookForm",onOnSubmit:n.onSubmit},{default:(0,s.w5)((()=>[(0,s._)("input",{type:"hidden",name:"id",value:o.id},null,8,ue),(0,s._)("div",de,[(0,s.Wm)(a,{type:"password",name:"authorPw",title:"비밀번호 입력",placeholder:"비밀번호 입력",rules:"required|minLength:8|maxLength:15"}),(0,s.Wm)(r,{type:"submit",color:"primary"},{default:(0,s.w5)((()=>[ce])),_:1})])])),_:1},8,["onOnSubmit"])])),_:1},8,["name"])}var _e={name:"app-remove-guestbook-modal",props:{id:String},components:{UiForm:J.Z,UiTextField:Q.Z},methods:{async onSubmit(e){const t=await ne.Z.confirmInfo("방명록을 삭제하시겠습니까?");t&&this.$http.delete(`/guestbook/${e.id}`,{data:e}).then((e=>{ne.Z.toastSuccess("방명록이 삭제되었습니다."),this.$modal.hide(this.$options.name)})).catch((e=>{ne.Z.toastError(e.response.data.message)}))}}};const pe=(0,oe.Z)(_e,[["render",ge]]);var me=pe,he={name:"app-guestbook",components:{UiForm:J.Z,UiTextField:Q.Z,UiTextarea:ie,UiSkeletor:le.Z,AppRemoveGuestbookModal:me},data(){return{pageTitle:"방명록",page:1,pageSize:6,listCnt:0,guestbookList:[],activeIndex:-1,isScrolled:!1,isLastPage:!1,dataLoaded:!1}},async created(){ae.Z.setPageTitle(this.pageTitle),await this.listGuestbook(),this.dataLoading()},mounted(){window.addEventListener("scroll",this.scroll),document.addEventListener("click",this.closeMenu)},unmounted(){window.removeEventListener("scroll",this.scroll),document.removeEventListener("click",this.closeMenu)},methods:{listGuestbook(){let e={page:this.page,pageSize:this.pageSize};return this.$http.get("/guestbook",{params:e}).then((e=>{0!==e.data[0].length?(e.data[0].map((e=>{e.cont=e.cont.replace("\n","<br>"),e.regDate=this.$moment(e.regDate).format("YYYY-MM-DD HH:mm:ss"),(0,re.UE)(e.modDate)&&(e.modDate=this.$moment(e.modDate).format("YYYY-MM-DD HH:mm:ss")),this.guestbookList.push(e)})),this.listCnt=e.data[1],this.listCnt===this.guestbookList.length&&(this.isLastPage=!0),this.isScrolled=!1):this.isScrolled=!1}))},toggleMenu(e){event.stopPropagation(),e!==this.activeIndex?this.activeIndex=e:this.activeIndex=-1},closeMenu(e){(0,re.UE)(this.$refs.guestbookMenuBtn)&&!this.$refs.guestbookMenuBtn.includes(e.target)&&(this.activeIndex=-1)},scroll(){const{scrollY:e}=window,{clientHeight:t,scrollHeight:o}=document.documentElement,s=t+e+100>=o;if(s&&!this.isScrolled){if(this.isLastPage)return;setTimeout((()=>{this.isScrolled=!0,this.page++,this.listGuestbook()}),500)}},openModal(e,t){"remove"===e&&this.$modal.show({component:me,bind:{id:t}})},async onSubmit(e){const t=await ne.Z.confirmSuccess("방명록을 등록하시겠습니까?");t&&this.$http.post("/guestbook",e).then((e=>{const t={...e.data};t.regDate=this.$moment(t.regDate).format("YYYY-MM-DD HH:mm:ss"),this.guestbookList.push(t),this.guestbookList=this.guestbookList.sort(((e,t)=>t.id-e.id)),ne.Z.toastSuccess("방명록이 등록되었습니다.")}))},dataLoading(){0<this.guestbookList.length&&(this.dataLoaded=!0)}}};const be=(0,oe.Z)(he,[["render",N],["__scopeId","data-v-7f637328"]]);var ke=be}}]);
//# sourceMappingURL=769.00ab7aa3.js.map