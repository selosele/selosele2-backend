"use strict";(self["webpackChunkselosele2"]=self["webpackChunkselosele2"]||[]).push([[486],{5486:function(e,t,a){a.r(t),a.d(t,{default:function(){return W}});var r=a(3396);const o={class:"d-flex flex--right gap--10 mb--15"};function i(e,t,a,i,l,m){const s=(0,r.up)("ui-icon-button"),n=(0,r.up)("ui-grid"),d=(0,r.up)("app-content-wrapper");return(0,r.wg)(),(0,r.j4)(d,null,{default:(0,r.w5)((()=>[(0,r._)("div",o,[(0,r.Wm)(s,{color:"primary",icon:"xi-pen",text:"그룹 생성",showText:!0,onClick:t[0]||(t[0]=e=>m.openModal("E01001"))}),(0,r.Wm)(s,{color:"dark",icon:"xi-trash",text:"그룹 삭제",showText:!0,onClick:m.removePrograms},null,8,["onClick"])]),(0,r.Wm)(n,{columnDefs:l.columnDefs,rowData:l.rowData,checkboxIndex:0,rowNumIndex:1,pagination:!0,onGridready:m.onGridReady,onCellclicked:m.onCellClicked},null,8,["columnDefs","rowData","onGridready","onCellclicked"])])),_:1})}var l=a(8822),m=a(7139);const s=e=>((0,r.dD)("data-v-d0aa5cc6"),e=e(),(0,r.Cn)(),e),n={class:"program__write__inputs"},d={class:"program__write__input-box"},u=s((()=>(0,r._)("label",{for:"programNm",class:"program__write__label"},"프로그램 그룹 명",-1))),p={class:"program__write__btns"},h={key:1,class:"d-flex flex--between align--center gap--10 mb--15"},c={class:"mt--0 mb--0"},g={class:"d-flex gap--10"};function D(e,t,a,o,i,l){const s=(0,r.up)("ui-hidden-field"),D=(0,r.up)("ui-text-field"),w=(0,r.up)("ui-button"),f=(0,r.up)("ui-grid"),_=(0,r.up)("ui-pane"),b=(0,r.up)("app-save-program-detail"),Y=(0,r.up)("ui-split-pane"),v=(0,r.up)("ui-form"),$=(0,r.up)("ui-modal");return(0,r.wg)(),(0,r.j4)($,{title:a.program?i.programNm:"프로그램 그룹 등록",name:this.$options.name,full:!0,class:"program-modal__wrapper"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,{name:"programForm",onOnsubmit:l.onSubmit},{default:(0,r.w5)((()=>[a.program?((0,r.wg)(),(0,r.j4)(s,{key:0,name:"id",value:a.program.id},null,8,["value"])):(0,r.kq)("",!0),(0,r._)("div",n,[(0,r._)("div",d,[u,(0,r.Wm)(D,{name:"nm",id:"programNm",rules:"required|max:50",value:a.program?.nm,modelValue:i.programNm,"onUpdate:modelValue":t[0]||(t[0]=e=>i.programNm=e)},null,8,["value","modelValue"])]),(0,r._)("div",p,[(0,r.Wm)(w,{type:"submit",color:"primary",text:"저장",class:(0,m.C_)("program__btn program__btn--write")}),a.program?((0,r.wg)(),(0,r.j4)(w,{key:0,type:"button",color:"dark",text:"삭제",class:(0,m.C_)("program__btn program__btn--write"),onClick:t[1]||(t[1]=e=>l.removePost(a.program.id))})):(0,r.kq)("",!0)])]),"E01002"===a.crudType?((0,r.wg)(),(0,r.iD)("div",h,[(0,r._)("p",c," 총 "+(0,m.zw)(this.rowData.length)+"개의 하위 프로그램 ",1),(0,r._)("div",g,[(0,r.Wm)(w,{type:"button",color:"primary",text:"추가",class:(0,m.C_)("program__btn program__btn--write"),onClick:l.addDetail},null,8,["onClick"]),(0,r.Wm)(w,{type:"button",color:"dark",text:"삭제",class:(0,m.C_)("program__btn program__btn--write"),onClick:l.removeDetail},null,8,["onClick"])])])):(0,r.kq)("",!0),(0,r.Wm)(Y,null,{default:(0,r.w5)((()=>[(0,r.Wm)(_,null,{default:(0,r.w5)((()=>[(0,r.Wm)(f,{columnDefs:i.columnDefs,rowData:i.rowData,checkboxIndex:0,pagination:!0,onGridready:l.onGridReady,onCellclicked:l.onCellClicked},null,8,["columnDefs","rowData","onGridready","onCellclicked"])])),_:1}),e.isSplitterActive?((0,r.wg)(),(0,r.j4)(_,{key:0},{default:(0,r.w5)((()=>[((0,r.wg)(),(0,r.j4)(b,{programDetail:i.programDetail,key:i.programDetail.id,onRefreshDetail:l.refreshDetail},null,8,["programDetail","onRefreshDetail"]))])),_:1})):(0,r.kq)("",!0)])),_:1})])),_:1},8,["onOnsubmit"])])),_:1},8,["title","name"])}function w(e,t,a,o,i,l){const m=(0,r.up)("ui-hidden-field"),s=(0,r.up)("ui-text-field"),n=(0,r.up)("ui-radio"),d=(0,r.up)("ui-radio-group"),u=(0,r.up)("ui-split-form");return(0,r.wg)(),(0,r.j4)(u,{name:"saveProgramDetailForm",onOnsubmit:l.onSubmit,onRemove:l.onRemove},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{name:"id",value:i.id},null,8,["value"]),(0,r.Wm)(m,{name:"parentId",value:i.parentId},null,8,["value"]),(0,r.Wm)(s,{name:"nm",id:"programDetailNm",label:"프로그램 명",rules:"required|max:50",block:!0,modelValue:i.nm,"onUpdate:modelValue":t[0]||(t[0]=e=>i.nm=e)},null,8,["modelValue"]),(0,r.Wm)(s,{name:"method",id:"programDetailMethod",label:"요청 메소드",rules:"required|max:7",block:!0,modelValue:i.method,"onUpdate:modelValue":t[1]||(t[1]=e=>i.method=e)},null,8,["modelValue"]),(0,r.Wm)(s,{name:"routePath",id:"programDetailRoutePath",label:"요청 URL ROUTE PATH",rules:"required|max:100",block:!0,modelValue:i.routePath,"onUpdate:modelValue":t[2]||(t[2]=e=>i.routePath=e)},null,8,["modelValue"]),(0,r.Wm)(s,{name:"regDate",id:"programDetailRegDate",label:"프로그램 등록일시",readonly:!0,block:!0,modelValue:i.regDate,"onUpdate:modelValue":t[3]||(t[3]=e=>i.regDate=e)},null,8,["modelValue"]),(0,r.Wm)(s,{name:"modDate",id:"programDetailModDate",label:"프로그램 수정일시",readonly:!0,block:!0,modelValue:i.modDate,"onUpdate:modelValue":t[4]||(t[4]=e=>i.modDate=e)},null,8,["modelValue"]),(0,r.Wm)(d,{label:"프로그램 사용 여부"},{default:(0,r.w5)((()=>[(0,r.Wm)(n,{id:"programDetailUseYn1",name:"useYn",label:"사용",value:"Y",rules:"required",modelValue:i.useYn,"onUpdate:modelValue":t[5]||(t[5]=e=>i.useYn=e)},null,8,["modelValue"]),(0,r.Wm)(n,{id:"programDetaillUseYn2",name:"useYn",label:"미사용",value:"N",rules:"required",modelValue:i.useYn,"onUpdate:modelValue":t[6]||(t[6]=e=>i.useYn=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["onOnsubmit","onRemove"])}var f={name:"AppSaveProgram",props:{programDetail:{type:Object,default:()=>({})}},data(){return{id:null,parentId:null,nm:"",method:"",routePath:"",regDate:"",modDate:"",useYn:""}},created(){this.id=this.programDetail.id,this.parentId=this.programDetail.parentId,this.nm=this.programDetail.nm,this.method=this.programDetail.method,this.routePath=this.programDetail.routePath,this.useYn=this.programDetail.useYn,this.regDate=this.$moment(this.programDetail.regDate).format("YYYY-MM-DD HH:mm:ss"),(0,l.SL)(this.programDetail.modDate)&&(this.modDate=this.$moment(this.programDetail.modDate).format("YYYY-MM-DD HH:mm:ss"))},methods:{async onSubmit(e){const t=await l.wW.confirmSuccess("저장하시겠습니까?");t&&this.$http.post("/programdetail",e).then((e=>{l.wW.toastSuccess("저장되었습니다."),this.$emit("refreshDetail",e.data)}))},async onRemove(e){const t=await l.wW.confirmSuccess("삭제하시겠습니까?");t&&this.$http.delete(`/programdetail/${e.id}`).then((async e=>{l.wW.toastSuccess("삭제되었습니다."),this.$emit("refreshDetail",e.data)}))}}},_=a(89);const b=(0,_.Z)(f,[["render",w]]);var Y=b,v={name:"AppProgramModal",components:{AppSaveProgramDetail:Y},props:{crudType:String,program:Object},data(){return{columnDefs:[{},{headerName:"프로그램 명",field:"nm"},{headerName:"요청 메소드",field:"method",width:80},{headerName:"ROUTE PATH",field:"routePath"},{headerName:"사용 여부",field:"useYnNm",width:80},{headerName:"등록일시",field:"regDate",width:100}],rowData:[],gridApi:null,programNm:"",programDetail:{}}},created(){(0,l.UE)(this.program)&&this.program.programDetail.forEach((e=>{const t=this.setData(e);this.rowData.push(t)}))},methods:{onGridReady(e){this.gridApi=e},onCellClicked(e){this.$http.get(`/programdetail/${e.data.id}`).then((e=>{this.programDetail={...e.data},this.$store.commit("Splitter/TOGGLE",!0)}))},getModalTitle(){switch(this.crudType){case"E01001":return"프로그램 그룹 등록";case"E01002":return this.programNm}},getUseYn(e){switch(e){case"Y":return"사용";case"N":return"미사용"}},async onSubmit(e){const t=await l.wW.confirmSuccess("그룹을 저장하시겠습니까?");t&&("E01001"!==this.crudType&&"E01002"!==this.crudType||this.$http.post("/program",e).then((e=>{l.wW.toastSuccess("저장되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Program/FETCH_SAVED_PROGRAM",e.data)})))},async removePost(e){const t=await l.wW.confirmSuccess("그룹을 삭제하시겠습니까?");t&&this.$http.delete(`/program/${e}`).then((e=>{l.wW.toastSuccess("삭제되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Program/FETCH_REMOVED_PROGRAM",e.data)}))},listDetail(e){return this.$http.get("/programdetail",{params:{parentId:e}}).then((e=>{e.data.forEach((e=>{const t=this.setData(e);this.rowData.push(t)}))}))},addDetail(){this.programDetail={parentId:this.program.id},this.$store.commit("Splitter/TOGGLE",!0)},async removeDetail(){const e=this.gridApi.getSelectedRows();if(0===e.length)return void l.wW.toastWarning("삭제할 하위 프로그램을 선택하세요.");const t=await l.wW.confirmSuccess("삭제하시겠습니까?");if(!t)return;let a=[];e.forEach((e=>{a.push({id:e.id})})),this.$http.post("/programdetail/remove",a).then((t=>{l.wW.toastSuccess("삭제되었습니다."),this.refreshDetail({parentId:e[0].parentId})}))},setData(e){return e.useYnNm=this.getUseYn(e.useYn),e.regDate=this.$moment(e.regDate).format("YYYY-MM-DD HH:mm:ss"),(0,l.SL)(e.modDate)&&(e.modDate=this.$moment(e.modDate).format("YYYY-MM-DD HH:mm:ss")),e},async refreshDetail(e){this.rowData=[],this.programDetail={},this.$store.commit("Splitter/TOGGLE",!1),await this.listDetail(e.parentId)}}};const $=(0,_.Z)(v,[["render",D],["__scopeId","data-v-d0aa5cc6"]]);var y=$,k={name:"AppAdminProgram",components:{AppProgramModal:y},data(){return{columnDefs:[{},{},{headerName:"프로그램 그룹 명",field:"nm"},{headerName:"등록일시",field:"regDate",width:100},{headerName:"수정일시",field:"modDate",width:100}],rowData:[],gridApi:null}},async created(){this.$store.dispatch("Breadcrumb/FETCH_PAGE_TITLE","프로그램 관리"),await this.listProgram()},watch:{async"$store.state.Program.savedProgram"(e){0<Object.values(e).length&&(await this.listProgram(),this.$store.dispatch("Program/FETCH_SAVED_PROGRAM",{}))},async"$store.state.Program.removedProgram"(e){0<Object.values(e).length&&(await this.listProgram(),this.$store.dispatch("Program/FETCH_REMOVED_PROGRAM",{}))}},methods:{onGridReady(e){this.gridApi=e},onCellClicked(e){this.$http.get(`/program/${e.data.id}`).then((e=>{e.data.regDate=this.$moment(e.data.regDate).format("YYYY-MM-DD HH:mm:ss"),(0,l.SL)(e.data.modDate)&&(e.data.modDate=this.$moment(e.data.modDate).format("YYYY-MM-DD HH:mm:ss")),this.openModal("E01002",e.data)}))},listProgram(){return this.$http.get("/program").then((e=>{e.data.forEach((e=>{e.regDate=this.$moment(e.regDate).format("YYYY-MM-DD HH:mm:ss"),(0,l.SL)(e.modDate)&&(e.modDate=this.$moment(e.modDate).format("YYYY-MM-DD HH:mm:ss"))})),this.rowData=[...e.data]}))},openModal(e,t=null){this.$store.commit("Splitter/TOGGLE",!1),"E01001"===e?this.$modal.show({component:y,bind:{crudType:e}}):"E01002"===e&&this.$modal.show({component:y,bind:{crudType:e,program:t}})},async removePrograms(){const e=this.gridApi.getSelectedRows();if(0===e.length)return void l.wW.toastWarning("삭제할 그룹을 선택하세요.");const t=await l.wW.confirmQuestion("하위 프로그램도 삭제됩니다. 계속하시겠습니까?");if(!t)return;let a=[];e.forEach((e=>{a.push({id:e.id})})),this.$http.post("/program/remove",a).then((e=>{this.gridApi.removeSelectedRows(),l.wW.toastSuccess("삭제되었습니다.")}))}}};const P=(0,_.Z)(k,[["render",i]]);var W=P}}]);