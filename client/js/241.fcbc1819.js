"use strict";(self["webpackChunkselosele2"]=self["webpackChunkselosele2"]||[]).push([[241],{6597:function(e,t,o){var s=o(9803),i=o(4722);class n{constructor(){}setPageTitle(e){(0,i.UE)(e)?document.title=`${e} - ${s.Z.state.BlogConfig.data.title}`:document.title=s.Z.state.BlogConfig.data.title}}const a=new n;t["Z"]=a},7620:function(e,t,o){o.d(t,{Z:function(){return r}});var s=o(3396);function i(e,t,o,i,n,a){const l=(0,s.up)("Field");return(0,s.wg)(),(0,s.j4)(l,(0,s.dG)({type:"hidden",id:o.id,ref:o.id,name:o.name,value:o.modelValue},e.$attrs),null,16,["id","name","value"])}var n=o(5708),a={name:"ui-hidden-field",components:{Field:n.gN,ErrorMessage:n.Bc},props:{type:String,id:String,name:String,modelValue:String}},l=o(89);const u=(0,l.Z)(a,[["render",i]]);var r=u},882:function(e,t,o){o.d(t,{Z:function(){return c}});var s=o(3396);const i=["id","name","title","cols","rows","placeholder","readonly","value"];function n(e,t,o,n,a,l){const u=(0,s.up)("Field"),r=(0,s.up)("ErrorMessage");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(u,{name:o.name,value:o.value,rules:o.rules},{default:(0,s.w5)((({field:a})=>[(0,s._)("textarea",(0,s.dG)({id:o.id,ref:e=>{n.inputEl=e},name:o.name,title:o.title,cols:o.cols,rows:o.rows,placeholder:o.placeholder,readonly:o.readonly,value:o.value},{...a,...e.$attrs},{onInput:t[0]||(t[0]=e=>n.onInput(e))}),"\r\n    ",16,i)])),_:1},8,["name","value","rules"]),(0,s.Wm)(r,{class:"form-field-error",name:o.name},null,8,["name"])],64)}var a=o(4870),l=o(5708),u={name:"ui-textarea",components:{Field:l.gN,ErrorMessage:l.Bc},props:{id:String,name:String,title:String,placeholder:String,cols:String,rows:String,readonly:Boolean,rules:String,value:{type:[String,Number],default:void 0},modelValue:{default:""}},setup(e,{emit:t}){const{value:o,errorMessage:s,handleBlur:i,handleChange:n,meta:u}=(0,l.U$)(e.name,e.rules,{initialValue:e.modelValue,valueProp:e.modelValue}),r=(0,a.iH)(null),d=e=>{t("update:modelValue",e.target.value)},c=()=>{r.value.focus()};return{inputEl:r,onInput:d,focus:c,handleChange:n,errorMessage:s,inputValue:o,meta:u}}},r=o(89);const d=(0,r.Z)(u,[["render",n]]);var c=d},1241:function(e,t,o){o.r(t),o.d(t,{default:function(){return Ce}});var s=o(3396),i=o(7139),n=o(9242);const a=e=>((0,s.dD)("data-v-b56bd62a"),e=e(),(0,s.Cn)(),e),l={class:"guestbook__wrapper"},u={class:"guestbook__write"},r={class:"guestbook__write__inputs"},d={class:"guestbook__write__input-box"},c=a((()=>(0,s._)("label",{for:"guestbookWriteAuthor"},"닉네임",-1))),p={class:"guestbook__write__input-box"},g=a((()=>(0,s._)("label",{for:"guestbookWritePw"},"비밀번호",-1))),m={class:"guestbook__write__btns d-flex-w gap--10"},_=(0,s.Uk)("다시작성 "),b=(0,s.Uk)("저장 "),h={key:1,class:"guestbook__depth1"},k=["innerHTML"],f={class:"guestbook__cont__info depth1"},v={class:"guestbook__author"},w=a((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-user-o","aria-hidden":"true"}),(0,s.Uk)(" 글쓴이 : ")],-1))),y={class:"guestbook__reg-date"},x=a((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-time-o","aria-hidden":"true"}),(0,s.Uk)(" 등록일 : ")],-1))),S=["title"],U=a((()=>(0,s._)("i",{class:"xi-message","aria-hidden":"true"},null,-1))),L={class:"reply_cnt"},$=a((()=>(0,s._)("div",{class:"guestbook__depth2"},[(0,s._)("ul")],-1))),C={class:"guestbook__toggle"},W=["onClick"],Z=a((()=>(0,s._)("i",{class:"xi-cog","aria-hidden":"true"},null,-1))),D=a((()=>(0,s._)("span",{class:"sr-only"},"방명록 수정/삭제",-1))),E=[Z,D],M={class:"guestbook__toggle-list"},T=["onClick"],F=a((()=>(0,s._)("i",{class:"xi-pen-o","aria-hidden":"true"},null,-1))),G=(0,s.Uk)(" 방명록 수정 "),H=[F,G],P=["onClick"],O=a((()=>(0,s._)("i",{class:"xi-trash-o","aria-hidden":"true"},null,-1))),Y=(0,s.Uk)(" 방명록 삭제 "),B=[O,Y];function q(e,t,o,a,Z,D){const F=(0,s.up)("ui-textarea"),G=(0,s.up)("ui-text-field"),O=(0,s.up)("ui-button"),Y=(0,s.up)("ui-form"),q=(0,s.up)("ui-skeletor"),I=(0,s.up)("app-guestbook-reply"),V=(0,s.up)("app-content-wrapper");return(0,s.wg)(),(0,s.j4)(V,{pageTitle:Z.pageTitle},{default:(0,s.w5)((()=>[(0,s._)("div",l,[(0,s.Wm)(Y,{class:(0,i.C_)("guestbook__write-frm"),name:"guestbookForm",onOnSubmit:D.onSubmit},{default:(0,s.w5)((()=>[(0,s._)("div",u,[(0,s.Wm)(F,{name:"cont",id:"guestbookWriteCont",class:(0,i.C_)("guestbook__textarea"),title:"방명록 내용 입력",placeholder:"하고싶은 말을 남겨주세요.",cols:"30",rows:"4",rules:"required"},null,8,["placeholder"]),(0,s._)("div",r,[(0,s._)("div",d,[c,(0,s._)("div",null,[(0,s.Wm)(G,{type:"text",name:"author",id:"guestbookWriteAuthor",class:(0,i.C_)("guestbook__input"),rules:"required|maxLength:20"})])]),(0,s._)("div",p,[g,(0,s._)("div",null,[(0,s.Wm)(G,{type:"password",name:"authorPw",id:"guestbookWritePw",class:(0,i.C_)("guestbook__input"),rules:"required|minLength:8|maxLength:15"})])]),(0,s._)("div",m,[(0,s.Wm)(O,{type:"reset",color:"secondary",class:(0,i.C_)("guestbook__btn guestbook__btn--reset")},{default:(0,s.w5)((()=>[_])),_:1}),(0,s.Wm)(O,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--write")},{default:(0,s.w5)((()=>[b])),_:1})])])])])),_:1},8,["onOnSubmit"]),Z.dataLoaded?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Wm)(q,{height:"1.3rem"},null,8,["height"]),(0,s.Wm)(q,{height:"1.3rem"},null,8,["height"]),(0,s.Wm)(q,{height:"1.3rem"},null,8,["height"])],64)),Z.dataLoaded?((0,s.wg)(),(0,s.iD)("ul",h,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Z.guestbookList,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{class:"guestbook__depth1__list",key:t},[(0,s._)("p",{class:"guestbook__cont",innerHTML:e.cont},null,8,k),(0,s._)("div",f,[(0,s._)("span",v,[w,(0,s.Uk)(" "+(0,i.zw)(e.author),1)]),(0,s._)("span",y,[x,(0,s.Uk)(" "+(0,i.zw)(e.regDate),1)])]),0<e.guestbookReply.length?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("button",{type:"button",class:"guestbook__btn guestbook__btn--reply-open",title:`댓글 ${e.guestbookReply.length}개 펼쳐보기`},[U,(0,s._)("span",L,(0,i.zw)(e.guestbookReply.length>99?"99+":e.guestbookReply.length),1)],8,S),$],64)):(0,s.kq)("",!0),(0,s.Wm)(I,{idx:t},null,8,["idx"]),(0,s._)("div",C,[(0,s._)("button",{type:"button",class:"guestbook__btn--toggle",onClick:e=>D.toggleMenu(t)},E,8,W),(0,s.wy)((0,s._)("div",M,[(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("button",{type:"button",class:"guestbook__btn--edit1",ref_for:!0,ref:"guestbookMenuBtn",onClick:t=>D.openModal("update",e)},H,8,T)]),(0,s._)("li",null,[(0,s._)("button",{type:"button",class:"guestbook__btn--delete1",ref_for:!0,ref:"guestbookMenuBtn",onClick:t=>D.openModal("remove",e)},B,8,P)])])],512),[[n.F8,t===Z.activeIndex]])])])))),128))])):(0,s.kq)("",!0)])])),_:1},8,["pageTitle"])}var I=o(2430),V=o(7973),A=o(882),R=o(3210),j=o(2222),z=o(6597),K=o(4722);const N={class:"guestbook__reply__wrapper"},J={class:"guestbook__reply__btns"},Q={class:"guestbook__reply__btns-inner"},X=["for"],ee=(0,s.Uk)("닉네임 "),te=["for"],oe=(0,s.Uk)("비밀번호 "),se=(0,s.Uk)("저장 ");function ie(e,t,o,n,a,l){const u=(0,s.up)("ui-textarea"),r=(0,s.up)("ui-text-field"),d=(0,s.up)("ui-button"),c=(0,s.up)("ui-form");return(0,s.wg)(),(0,s.iD)("div",N,[(0,s.Wm)(c,{name:`guestbookReplyForm${o.idx}`},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{name:"cont",id:`replyCont${o.idx}`,class:(0,i.C_)("guestbook__reply__cont guestbook__textarea"),title:"댓글 입력",placeholder:"댓글을 남겨주세요.",cols:"30",rows:"3",rules:"required"},null,8,["id","placeholder"]),(0,s._)("div",J,[(0,s._)("div",Q,[(0,s._)("label",{for:`replyAuthor${o.idx}`},[ee,(0,s.Wm)(r,{type:"text",name:"author",id:`replyAuthor${o.idx}`,class:(0,i.C_)("guestbook__input"),rules:"required|maxLength:20"},null,8,["id"])],8,X),(0,s._)("label",{for:`replyPw${o.idx}`},[oe,(0,s.Wm)(r,{type:"password",name:"authorPw",id:`replyPw${o.idx}`,class:(0,i.C_)("guestbook__input"),rules:"required|minLength:8|maxLength:15"},null,8,["id"])],8,te)]),(0,s.Wm)(d,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--reply-write")},{default:(0,s.w5)((()=>[se])),_:1})])])),_:1},8,["name"])])}var ne={name:"app-guestbook-reply",props:{idx:Number},components:{UiForm:I.Z,UiTextField:V.Z,UiTextarea:A.Z,UiSkeletor:R.Z}},ae=o(89);const le=(0,ae.Z)(ne,[["render",ie],["__scopeId","data-v-6c0f561c"]]);var ue=le;const re={class:"d-flex-w gap--15 mt--20"},de={for:"guestbookUpdateAuthor"},ce=(0,s.Uk)("닉네임 "),pe={for:"guestbookUpdatePw"},ge=(0,s.Uk)("비밀번호 "),me=(0,s.Uk)("수정 ");function _e(e,t,o,n,a,l){const u=(0,s.up)("ui-hidden-field"),r=(0,s.up)("ui-textarea"),d=(0,s.up)("ui-text-field"),c=(0,s.up)("ui-button"),p=(0,s.up)("ui-form"),g=(0,s.up)("ui-modal");return(0,s.wg)(),(0,s.j4)(g,{title:"방명록 수정",name:this.$options.name},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{name:"removeGuestbookForm",onOnSubmit:l.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{name:"id",value:o.guestbook.id},null,8,["value"]),(0,s.Wm)(r,{name:"cont",id:"guestbookUpdateCont",class:(0,i.C_)("resize--vertical"),title:"방명록 내용 입력",placeholder:"하고싶은 말을 남겨주세요.",cols:"30",rows:"4",rules:"required",value:o.guestbook.cont},null,8,["placeholder","value"]),(0,s._)("div",re,[(0,s._)("label",de,[ce,(0,s.Wm)(d,{type:"text",name:"author",id:"guestbookUpdateAuthor",class:(0,i.C_)("guestbook__input"),rules:"required|maxLength:20",value:o.guestbook.author},null,8,["value"])]),(0,s._)("label",pe,[ge,(0,s.Wm)(d,{type:"password",name:"authorPw",id:"guestbookUpdatePw",class:(0,i.C_)("guestbook__input"),rules:"required|minLength:8|maxLength:15"})]),(0,s.Wm)(c,{type:"submit",color:"primary"},{default:(0,s.w5)((()=>[me])),_:1})])])),_:1},8,["onOnSubmit"])])),_:1},8,["name"])}var be={name:"app-update-guestbook-modal",props:{guestbook:Object},components:{UiForm:I.Z,UiTextField:V.Z,UiTextarea:A.Z},methods:{async onSubmit(e){const t=await j.Z.confirmSuccess("방명록을 수정하시겠습니까?");t&&this.$http.put(`/guestbook/${e.id}`,e).then((e=>{j.Z.toastSuccess("방명록이 수정되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Guestbook/FETCH_UPDATED_GUESTBOOK",e.data)}))}}};const he=(0,ae.Z)(be,[["render",_e]]);var ke=he;const fe={class:"d-flex-w gap--10"},ve=(0,s.Uk)("삭제 ");function we(e,t,o,i,n,a){const l=(0,s.up)("ui-hidden-field"),u=(0,s.up)("ui-text-field"),r=(0,s.up)("ui-button"),d=(0,s.up)("ui-form"),c=(0,s.up)("ui-modal");return(0,s.wg)(),(0,s.j4)(c,{title:"방명록 삭제",name:this.$options.name},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{name:"removeGuestbookForm",onOnSubmit:a.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{name:"id",value:o.id},null,8,["value"]),(0,s._)("div",fe,[(0,s._)("div",null,[(0,s.Wm)(u,{type:"password",name:"authorPw",id:"guestbookRemovePw",title:"비밀번호 입력",placeholder:"비밀번호 입력",readonly:e.isLogin,rules:e.isLogin?"":"required|min:8|max:15"},null,8,["readonly","rules"])]),(0,s.Wm)(r,{type:"submit",color:"primary"},{default:(0,s.w5)((()=>[ve])),_:1})])])),_:1},8,["onOnSubmit"])])),_:1},8,["name"])}var ye=o(7620),xe={name:"app-remove-guestbook-modal",props:{id:String},components:{UiForm:I.Z,UiTextField:V.Z,UiHiddenField:ye.Z},methods:{async onSubmit(e){const t=await j.Z.confirmSuccess("방명록을 삭제하시겠습니까?");t&&this.$http.delete(`/guestbook/${e.id}`,{data:e}).then((t=>{j.Z.toastSuccess("방명록이 삭제되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Guestbook/FETCH_REMOVED_GUESTBOOK",e)}))}}};const Se=(0,ae.Z)(xe,[["render",we]]);var Ue=Se,Le={name:"app-guestbook",components:{UiForm:I.Z,UiTextField:V.Z,UiTextarea:A.Z,UiSkeletor:R.Z,AppGuestbookReply:ue},data(){return{pageTitle:"방명록",page:1,pageSize:6,listCnt:0,guestbookList:[],activeIndex:-1,isScrolled:!1,isLastPage:!1,dataLoaded:!1}},async created(){z.Z.setPageTitle(this.pageTitle),await this.listGuestbook(),this.dataLoading()},mounted(){window.addEventListener("scroll",this.scroll),document.addEventListener("click",this.closeMenu)},unmounted(){window.removeEventListener("scroll",this.scroll),document.removeEventListener("click",this.closeMenu)},watch:{"$store.state.Guestbook.updatedGuestbook":function(e){if(0<Object.values(e).length){const{id:t,author:o,cont:s,modDate:i}=e,n=this.guestbookList.findIndex((e=>e.id==t));this.guestbookList[n].author=o,this.guestbookList[n].cont=s,this.guestbookList[n].modDate=i,this.$store.dispatch("Guestbook/FETCH_UPDATED_GUESTBOOK",{})}},"$store.state.Guestbook.removedGuestbook":function(e){if(0<Object.values(e).length){const{id:t}=e,o=this.guestbookList.findIndex((e=>e.id==t));this.guestbookList.splice(o,1),this.$store.dispatch("Guestbook/FETCH_REMOVED_GUESTBOOK",{})}}},methods:{listGuestbook(){let e={page:this.page,pageSize:this.pageSize};return this.$http.get("/guestbook",{params:e}).then((e=>{0!==e.data[0].length?(e.data[0].map((e=>{e.cont=e.cont.replace("\n","<br>"),e.regDate=this.$moment(e.regDate).format("YYYY-MM-DD HH:mm:ss"),(0,K.UE)(e.modDate)&&(e.modDate=this.$moment(e.modDate).format("YYYY-MM-DD HH:mm:ss")),this.guestbookList.push(e)})),this.listCnt=e.data[1],this.listCnt===this.guestbookList.length&&(this.isLastPage=!0),this.isScrolled=!1):this.isScrolled=!1}))},toggleMenu(e){event.stopPropagation(),e!==this.activeIndex?this.activeIndex=e:this.activeIndex=-1},closeMenu(e){(0,K.UE)(this.$refs["guestbookMenuBtn"])&&!this.$refs["guestbookMenuBtn"].includes(e.target)&&(this.activeIndex=-1)},scroll(){const{scrollY:e}=window,{clientHeight:t,scrollHeight:o}=document.documentElement,s=t+e+100>=o;if(s&&!this.isScrolled){if(this.isLastPage)return;setTimeout((()=>{this.isScrolled=!0,this.page++,this.listGuestbook()}),100)}},openModal(e,t){"update"===e&&this.$modal.show({component:ke,bind:{guestbook:t}}),"remove"===e&&this.$modal.show({component:Ue,bind:{id:t.id}})},async onSubmit(e){const t=await j.Z.confirmSuccess("저장하시겠습니까?");t&&this.$http.post("/guestbook",e).then((e=>{const t={...e.data};t.regDate=this.$moment(t.regDate).format("YYYY-MM-DD HH:mm:ss"),this.guestbookList.push(t),this.guestbookList=this.guestbookList.sort(((e,t)=>t.id-e.id)),j.Z.toastSuccess("저장되었습니다.")}))},dataLoading(){0<this.guestbookList.length&&(this.dataLoaded=!0)}}};const $e=(0,ae.Z)(Le,[["render",q],["__scopeId","data-v-b56bd62a"]]);var Ce=$e}}]);
//# sourceMappingURL=241.fcbc1819.js.map