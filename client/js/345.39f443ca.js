"use strict";(self["webpackChunkselosele2"]=self["webpackChunkselosele2"]||[]).push([[345],{6597:function(e,t,a){a.d(t,{a:function(){return s}});var o=a(9266),r=a(8822);class i{constructor(){}setPageTitle(e){(0,r.UE)(e)?document.title=`${e} - ${o.Z.state.BlogConfig.data?.title}`:document.title=o.Z.state.BlogConfig.data?.title}}const s=new i},5345:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var o=a(3396);const r=(0,o.Uk)("추가 "),i=(0,o.Uk)("추가 ");function s(e,t,a,s,n,d){const l=(0,o.up)("ui-skeletor"),g=(0,o.up)("ui-button"),c=(0,o.up)("ui-tree"),h=(0,o.up)("ui-pane"),u=(0,o.up)("ui-loading"),p=(0,o.up)("app-save-category"),y=(0,o.up)("ui-split-pane"),m=(0,o.up)("ui-tab"),C=(0,o.up)("ui-tabs"),f=(0,o.up)("app-content-wrapper");return(0,o.wg)(),(0,o.j4)(f,{pageTitle:n.pageTitle},{default:(0,o.w5)((()=>[n.dataLoaded?((0,o.wg)(),(0,o.j4)(C,{key:1,onTabChanged:d.onTabChanged},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{name:"카테고리"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(h,{isTransparent:!0},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{nodes:n.categoryTree,useCheckbox:!1,filter:!0,placeholder:"카테고리/포스트 제목 입력",onNodeClick:d.onNodeClick},{btn:(0,o.w5)((()=>[(0,o.Wm)(g,{color:"primary",onClick:d.addCategory},{default:(0,o.w5)((()=>[r])),_:1},8,["onClick"])])),_:1},8,["nodes","onNodeClick"])])),_:1}),e.isSplitterActive?((0,o.wg)(),(0,o.j4)(h,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{activeModel:!n.dataLoaded2},null,8,["activeModel"]),n.dataLoaded2?((0,o.wg)(),(0,o.j4)(p,{category:n.category,type:"D01004",key:n.type+n.category.id,onRefreshCategory:d.refreshTree},null,8,["category","onRefreshCategory"])):(0,o.kq)("",!0)])),_:1})):(0,o.kq)("",!0)])),_:1})])),_:1}),(0,o.Wm)(m,{name:"태그"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(h,{isTransparent:!0},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{nodes:n.tagTree,useCheckbox:!1,filter:!0,placeholder:"태그/포스트 제목 입력",onNodeClick:d.onNodeClick},{btn:(0,o.w5)((()=>[(0,o.Wm)(g,{color:"primary",onClick:d.addCategory},{default:(0,o.w5)((()=>[i])),_:1},8,["onClick"])])),_:1},8,["nodes","onNodeClick"])])),_:1}),e.isSplitterActive?((0,o.wg)(),(0,o.j4)(h,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{activeModel:!n.dataLoaded2},null,8,["activeModel"]),n.dataLoaded2?((0,o.wg)(),(0,o.j4)(p,{category:n.category,type:"D01005",key:n.type+n.category.id,onRefreshCategory:d.refreshTree},null,8,["category","onRefreshCategory"])):(0,o.kq)("",!0)])),_:1})):(0,o.kq)("",!0)])),_:1})])),_:1})])),_:1},8,["onTabChanged"])):((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Wm)(l,{height:"1.3rem"},null,8,["height"]),(0,o.Wm)(l,{height:"1.3rem"},null,8,["height"]),(0,o.Wm)(l,{height:"1.3rem"},null,8,["height"])],64))])),_:1},8,["pageTitle"])}function n(e,t,a,r,i,s){const n=(0,o.up)("ui-hidden-field"),d=(0,o.up)("ui-text-field"),l=(0,o.up)("ui-split-form");return(0,o.wg)(),(0,o.j4)(l,{name:"saveCategoryForm",btnRemove:!0,onOnsubmit:s.onSubmit,onRemove:s.onRemove},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{name:"id",value:a.category.id},null,8,["value"]),(0,o.Wm)(n,{name:"type",value:a.type},null,8,["value"]),(0,o.Wm)(d,{type:"text",name:"nm",id:"categoryNm",label:"카테고리 명",rules:"required|max:50",block:!0,value:a.category.nm},null,8,["value"]),(0,o.Wm)(d,{type:"text",name:"regDate",id:"categoryRegDate",label:"카테고리 등록일시",readonly:!0,block:!0,value:a.category.regDate},null,8,["value"])])),_:1},8,["onOnsubmit","onRemove"])}var d=a(8822),l={name:"app-save-category",props:{category:Object,type:String},methods:{async onSubmit(e){const t=await d.wW.confirmSuccess("저장하시겠습니까?");t&&((0,d.xb)(e.id)?this.addCategory(e):this.updateCategory(e))},async onRemove(e){if((0,d.xb)(e.id))return;const t=await d.wW.confirmSuccess("삭제하시겠습니까?");t&&this.$http.delete(`/${this.getApiUri(e)}/${e.id}`).then((e=>{d.wW.toastSuccess("삭제되었습니다."),this.$emit("refreshCategory")}))},addCategory(e){return this.$http.post(`/${this.getApiUri(e)}`,e).then((e=>{d.wW.toastSuccess("저장되었습니다."),this.$emit("refreshCategory")}))},updateCategory(e){return this.$http.put(`/${this.getApiUri(e)}`,e).then((e=>{d.wW.toastSuccess("저장되었습니다."),this.$emit("refreshCategory")}))},getApiUri(e){return"D01004"===e.type?"category":"D01005"===e.type?"tag":""}}},g=a(89);const c=(0,g.Z)(l,[["render",n]]);var h=c,u=a(6597),p={name:"app-admin-category",components:{AppSaveCategory:h},data(){return{pageTitle:"카테고리/태그 관리",categoryTree:[],tagTree:[],category:{},type:"",activeIndex:-1,dataLoaded:!1,dataLoaded2:!1}},created(){this.init()},methods:{async init(){u.a.setPageTitle(this.pageTitle),await Promise.all([this.listCategoryTreeAndPost(),this.listTagTreeAndPost()]),this.$store.commit("Splitter/TOGGLE",!0),this.dataLoaded=!0,this.dataLoaded2=!0},listCategoryTreeAndPost(){return this.$http.get("/category/list/tree").then((e=>{this.createTree(e.data,"D01004")}))},listTagTreeAndPost(){return this.$http.get("/tag/list/tree").then((e=>{this.createTree(e.data,"D01005")}))},createTree(e,t){e.forEach((e=>{let a=[];"D01004"===t?a=e.postCategory:"D01005"===t&&(a=e.postTag);let o={id:e.id,label:this.getTreeLabel(e.nm,t),nodes:a.map(((e,t,a)=>0===a.length?{}:{id:e.postId,label:e.post.title}))};this.pushNode(o,t)}))},async refreshTree(){this.resetCategory(),this.categoryTree=[],this.tagTree=[],await Promise.all([this.listCategoryTreeAndPost(),this.listTagTreeAndPost()])},getTreeLabel(e,t){return"D01004"===t?e:`#${e}`},pushNode(e,t){"D01004"===t?this.categoryTree.push(e):"D01005"===t&&this.tagTree.push(e)},async onNodeClick(e){this.$store.commit("Splitter/TOGGLE",!0),(0,d.UE)(e.nodes)&&e.id!==this.category?.id&&(this.dataLoaded2=!1,await this.getCategory(e),this.dataLoading2())},onTabChanged(e){this.activeIndex=e.tab.index},getCategory(e){return 0===this.activeIndex&&(this.type="category"),1===this.activeIndex&&(this.type="tag"),this.$http.get(`/${this.type}/${e.id}`).then((e=>{this.category={...e.data},this.category.regDate=this.$moment(this.category.regDate).format("YYYY-MM-DD HH:mm:ss")}))},addCategory(){this.resetCategory()},resetCategory(){this.category={},this.category.id=null},dataLoading2(){(0,d.UE)(this.category)&&0<Object.values(this.category).length&&(this.dataLoaded2=!0)}}};const y=(0,g.Z)(p,[["render",s]]);var m=y}}]);
//# sourceMappingURL=345.39f443ca.js.map