"use strict";(self["webpackChunkselosele2"]=self["webpackChunkselosele2"]||[]).push([[29],{6597:function(t,e,o){o.d(e,{a:function(){return u}});var s=o(9266),i=o(8822);class a{constructor(){}setPageTitle(t){(0,i.UE)(t)?document.title=`${t} - ${s.Z.state.BlogConfig.data?.title}`:document.title=s.Z.state.BlogConfig.data?.title}}const u=new a},4029:function(t,e,o){o.r(e),o.d(e,{default:function(){return mt}});var s=o(3396),i=o(7139),a=o(9242);const u=t=>((0,s.dD)("data-v-6f53e900"),t=t(),(0,s.Cn)(),t),n={class:"guestbook__wrapper"},l={class:"guestbook__write"},r={class:"guestbook__write__inputs"},d={class:"guestbook__write__input-box"},c=u((()=>(0,s._)("label",{for:"guestbookWriteAuthor",class:"pt--5"},"닉네임",-1))),p={class:"guestbook__write__input-box"},_=u((()=>(0,s._)("label",{for:"guestbookWritePw",class:"pt--5"},"비밀번호",-1))),g={class:"guestbook__write__btns d-flex-w gap--10"},b=(0,s.Uk)("다시작성 "),m=(0,s.Uk)("저장 "),h={key:1,class:"guestbook__depth1"},k=["innerHTML"],w={class:"guestbook__cont__info depth1"},f={class:"guestbook__author"},v=u((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-user-o","aria-hidden":"true"}),(0,s.Uk)(" 글쓴이 : ")],-1))),y={class:"guestbook__reg-date"},x=u((()=>(0,s._)("strong",null,[(0,s._)("i",{class:"xi-time-o","aria-hidden":"true"}),(0,s.Uk)(" 등록일 : ")],-1))),W={class:"reply_cnt"},C=u((()=>(0,s._)("div",{class:"guestbook__depth2"},[(0,s._)("ul")],-1))),$={class:"guestbook__toggle"},L=["onClick"],D=u((()=>(0,s._)("i",{class:"xi-cog","aria-hidden":"true"},null,-1))),S=u((()=>(0,s._)("span",{class:"sr-only"},"방명록 수정/삭제",-1))),U=[D,S],E={class:"guestbook__toggle-list"},M=["onClick"],T=u((()=>(0,s._)("i",{class:"xi-pen-o","aria-hidden":"true"},null,-1))),Y=(0,s.Uk)(" 방명록 수정 "),O=[T,Y],P=["onClick"],G=u((()=>(0,s._)("i",{class:"xi-trash-o","aria-hidden":"true"},null,-1))),H=(0,s.Uk)(" 방명록 삭제 "),R=[G,H];function q(t,e,o,u,D,S){const T=(0,s.up)("ui-textarea"),Y=(0,s.up)("ui-text-field"),G=(0,s.up)("ui-button"),H=(0,s.up)("ui-form"),q=(0,s.up)("ui-skeletor"),B=(0,s.up)("ui-icon-button"),A=(0,s.up)("app-guestbook-reply"),F=(0,s.up)("app-content-wrapper");return(0,s.wg)(),(0,s.j4)(F,{pageTitle:D.pageTitle},{default:(0,s.w5)((()=>[(0,s._)("div",n,[(0,s.Wm)(H,{class:(0,i.C_)("guestbook__write-frm"),name:"guestbookForm",onOnsubmit:S.onSubmit},{default:(0,s.w5)((()=>[(0,s._)("div",l,[(0,s.Wm)(T,{name:"cont",id:"guestbookWriteCont",class:(0,i.C_)("guestbook__textarea"),title:"방명록 내용 입력",placeholder:"하고싶은 말을 남겨주세요.",cols:"30",rows:"4",rules:"required"},null,8,["placeholder"]),(0,s._)("div",r,[(0,s._)("div",d,[c,(0,s.Wm)(Y,{type:"text",name:"author",id:"guestbookWriteAuthor",class:(0,i.C_)("guestbook__input"),rules:"required|max:20",readonly:t.isLogin,value:t.isLogin?"관리자":""},null,8,["readonly","value"])]),(0,s._)("div",p,[_,(0,s.Wm)(Y,{type:"password",name:"authorPw",id:"guestbookWritePw",class:(0,i.C_)("guestbook__input"),rules:"required|min:8|max:15"})]),(0,s._)("div",g,[(0,s.Wm)(G,{type:"reset",color:"secondary",class:(0,i.C_)("guestbook__btn guestbook__btn--reset")},{default:(0,s.w5)((()=>[b])),_:1}),(0,s.Wm)(G,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--write")},{default:(0,s.w5)((()=>[m])),_:1})])])])])),_:1},8,["onOnsubmit"]),D.dataLoaded?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Wm)(q,{height:"1.3rem"},null,8,["height"]),(0,s.Wm)(q,{height:"1.3rem"},null,8,["height"]),(0,s.Wm)(q,{height:"1.3rem"},null,8,["height"])],64)),D.dataLoaded?((0,s.wg)(),(0,s.iD)("ul",h,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(D.guestbookList,((t,e)=>((0,s.wg)(),(0,s.iD)("li",{class:"guestbook__depth1__list",key:e},[(0,s._)("p",{class:"guestbook__cont",innerHTML:t.cont},null,8,k),(0,s._)("div",w,[(0,s._)("span",f,[v,(0,s._)("span",{class:(0,i.C_)({"font--bold":"Y"===t.adminYn})},(0,i.zw)(t.author),3)]),(0,s._)("span",y,[x,(0,s.Uk)(" "+(0,i.zw)(t.regDate),1)])]),0<t.guestbookReply.length?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Wm)(B,{type:"button",icon:"xi-message",class:(0,i.C_)("guestbook__btn guestbook__btn--reply-open"),title:`댓글 ${t.guestbookReply.length}개 펼쳐보기`},{default:(0,s.w5)((()=>[(0,s._)("span",W,(0,i.zw)(99<t.guestbookReply.length?"99+":t.guestbookReply.length),1)])),_:2},1032,["title"]),C],64)):(0,s.kq)("",!0),(0,s.Wm)(A,{idx:e},null,8,["idx"]),(0,s._)("div",$,[(0,s._)("button",{type:"button",class:"guestbook__btn--toggle",onClick:t=>S.toggleMenu(e)},U,8,L),(0,s.wy)((0,s._)("div",E,[(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("button",{type:"button",class:"guestbook__btn--edit1",ref_for:!0,ref:"guestbookMenuBtn",onClick:e=>S.openModal("update",t)},O,8,M)]),(0,s._)("li",null,[(0,s._)("button",{type:"button",class:"guestbook__btn--delete1",ref_for:!0,ref:"guestbookMenuBtn",onClick:e=>S.openModal("remove",t)},R,8,P)])])],512),[[a.F8,e===D.activeIndex]])])])))),128))])):(0,s.kq)("",!0)])])),_:1},8,["pageTitle"])}var B=o(8822),A=o(6597);const F={class:"guestbook__reply__wrapper"},I={class:"guestbook__reply__btns"},z={class:"guestbook__reply__btns-inner"},j=["for"],Z=["for"],K=(0,s.Uk)("저장 ");function V(t,e,o,a,u,n){const l=(0,s.up)("ui-textarea"),r=(0,s.up)("ui-text-field"),d=(0,s.up)("ui-button"),c=(0,s.up)("ui-form");return(0,s.wg)(),(0,s.iD)("div",F,[(0,s.Wm)(c,{name:`guestbookReplyForm${o.idx}`},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{name:"cont",id:`guestbookReplyCont${o.idx}`,class:(0,i.C_)("guestbook__reply__cont guestbook__textarea"),title:"댓글 입력",placeholder:"댓글을 남겨주세요.",cols:"30",rows:"3",rules:"required"},null,8,["id","placeholder"]),(0,s._)("div",I,[(0,s._)("div",z,[(0,s._)("label",{for:`guestbookReplyAuthor${o.idx}`,class:"pt--5"},"닉네임",8,j),(0,s.Wm)(r,{type:"text",name:"author",id:`guestbookReplyAuthor${o.idx}`,class:(0,i.C_)("guestbook__input"),rules:"required|max:20"},null,8,["id"]),(0,s._)("label",{for:`guestbookReplyPw${o.idx}`,class:"pt--5"},"비밀번호",8,Z),(0,s.Wm)(r,{type:"password",name:"authorPw",id:`guestbookReplyPw${o.idx}`,class:(0,i.C_)("guestbook__input"),rules:"required|min:8|max:15"},null,8,["id"])]),(0,s.Wm)(d,{type:"submit",color:"primary",class:(0,i.C_)("guestbook__btn guestbook__btn--reply-write")},{default:(0,s.w5)((()=>[K])),_:1})])])),_:1},8,["name"])])}var N={name:"app-guestbook-reply",props:{idx:Number}},J=o(89);const Q=(0,J.Z)(N,[["render",V],["__scopeId","data-v-73dc5bec"]]);var X=Q;const tt={class:"d-flex-w gap--15 mt--20"},et=(0,s._)("label",{for:"guestbookUpdateAuthor",class:"pt--5"},"닉네임",-1),ot=(0,s._)("label",{for:"guestbookUpdatePw",class:"pt--5"},"비밀번호",-1),st=(0,s.Uk)("수정 ");function it(t,e,o,a,u,n){const l=(0,s.up)("ui-hidden-field"),r=(0,s.up)("ui-textarea"),d=(0,s.up)("ui-text-field"),c=(0,s.up)("ui-button"),p=(0,s.up)("ui-form"),_=(0,s.up)("ui-modal");return(0,s.wg)(),(0,s.j4)(_,{title:"방명록 수정",name:this.$options.name},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{name:"removeGuestbookForm",onOnsubmit:n.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{name:"id",value:o.guestbook.id},null,8,["value"]),(0,s.Wm)(r,{name:"cont",id:"guestbookUpdateCont",title:"방명록 내용 입력",placeholder:"하고싶은 말을 남겨주세요.",cols:"30",rows:"4",resize:"vertical",rules:"required",value:o.guestbook.cont},null,8,["placeholder","value"]),(0,s._)("div",tt,[et,(0,s.Wm)(d,{type:"text",name:"author",id:"guestbookUpdateAuthor",class:(0,i.C_)("guestbook__input"),rules:"required|max:20",readonly:"Y"===o.guestbook.adminYn,value:o.guestbook.author},null,8,["readonly","value"]),ot,(0,s.Wm)(d,{type:"password",name:"authorPw",id:"guestbookUpdatePw",class:(0,i.C_)("guestbook__input"),rules:"required|min:8|max:15"}),(0,s.Wm)(c,{type:"submit",color:"primary"},{default:(0,s.w5)((()=>[st])),_:1})])])),_:1},8,["onOnsubmit"])])),_:1},8,["name"])}var at={name:"app-update-guestbook-modal",props:{guestbook:Object},methods:{async onSubmit(t){const e=await B.wW.confirmSuccess("방명록을 수정하시겠습니까?");e&&this.$http.put("/guestbook",t).then((t=>{B.wW.toastSuccess("방명록이 수정되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Guestbook/FETCH_UPDATED_GUESTBOOK",t.data)}))}}};const ut=(0,J.Z)(at,[["render",it]]);var nt=ut;const lt={class:"d-flex-w gap--10"},rt=(0,s.Uk)("삭제 ");function dt(t,e,o,i,a,u){const n=(0,s.up)("ui-hidden-field"),l=(0,s.up)("ui-text-field"),r=(0,s.up)("ui-button"),d=(0,s.up)("ui-form"),c=(0,s.up)("ui-modal");return(0,s.wg)(),(0,s.j4)(c,{title:"방명록 삭제",name:this.$options.name},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{name:"removeGuestbookForm",onOnsubmit:u.onSubmit},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{name:"id",value:o.id},null,8,["value"]),(0,s._)("div",lt,[(0,s.Wm)(l,{type:"password",name:"authorPw",id:"guestbookRemovePw",title:"비밀번호 입력",placeholder:"비밀번호 입력",readonly:t.isLogin,rules:t.isLogin?"":"required|min:8|max:15"},null,8,["readonly","rules"]),(0,s.Wm)(r,{type:"submit",color:"primary"},{default:(0,s.w5)((()=>[rt])),_:1})])])),_:1},8,["onOnsubmit"])])),_:1},8,["name"])}var ct={name:"app-remove-guestbook-modal",props:{id:String},methods:{async onSubmit(t){const e=await B.wW.confirmSuccess("방명록을 삭제하시겠습니까?");e&&this.$http.delete(`/guestbook/${t.id}`,{data:t}).then((e=>{B.wW.toastSuccess("방명록이 삭제되었습니다."),this.$modal.hide(this.$options.name),this.$store.dispatch("Guestbook/FETCH_REMOVED_GUESTBOOK",t)}))}}};const pt=(0,J.Z)(ct,[["render",dt]]);var _t=pt,gt={name:"app-guestbook",components:{AppGuestbookReply:X},data(){return{pageTitle:"방명록",page:1,pageSize:6,listCnt:0,guestbookList:[],activeIndex:-1,isScrolled:!1,isLastPage:!1,dataLoaded:!1}},async created(){A.a.setPageTitle(this.pageTitle),await this.listGuestbook(),this.dataLoading()},mounted(){window.addEventListener("scroll",this.onScroll),document.addEventListener("click",this.closeMenu)},unmounted(){window.removeEventListener("scroll",this.onScroll),document.removeEventListener("click",this.closeMenu)},watch:{"$store.state.Guestbook.updatedGuestbook"(t){if(0<Object.values(t).length){const{id:e,author:o,cont:s,modDate:i}=t,a=this.guestbookList.find((t=>t.id==e));a.author=o,a.cont=s,a.modDate=i,this.$store.dispatch("Guestbook/FETCH_UPDATED_GUESTBOOK",{})}},"$store.state.Guestbook.removedGuestbook"(t){if(0<Object.values(t).length){const{id:e}=t,o=this.guestbookList.findIndex((t=>t.id==e));this.guestbookList.splice(o,1),this.$store.dispatch("Guestbook/FETCH_REMOVED_GUESTBOOK",{})}}},methods:{listGuestbook(){let t={page:this.page,pageSize:this.pageSize};return this.$http.get("/guestbook",{params:t}).then((t=>{0!==t.data[0].length?(t.data[0].map((t=>{t.cont=t.cont.replace("\n","<br>"),t.regDate=this.$moment(t.regDate).format("YYYY-MM-DD HH:mm:ss"),(0,B.UE)(t.modDate)&&(t.modDate=this.$moment(t.modDate).format("YYYY-MM-DD HH:mm:ss")),this.guestbookList.push(t)})),this.listCnt=t.data[1],this.listCnt===this.guestbookList.length&&(this.isLastPage=!0),this.isScrolled=!1):this.isScrolled=!1}))},toggleMenu(t){event.stopPropagation(),t!==this.activeIndex?this.activeIndex=t:this.activeIndex=-1},closeMenu(t){(0,B.UE)(this.$refs["guestbookMenuBtn"])&&!this.$refs["guestbookMenuBtn"].includes(t.target)&&(this.activeIndex=-1)},onScroll(){const{scrollY:t}=window,{clientHeight:e,scrollHeight:o}=document.documentElement,s=e+t+100>=o;if(s&&!this.isScrolled){if(this.isLastPage)return;setTimeout((()=>{this.isScrolled=!0,this.page++,this.listGuestbook()}),100)}},openModal(t,e){"update"===t?this.$modal.show({component:nt,bind:{guestbook:e}}):"remove"===t&&this.$modal.show({component:_t,bind:{id:e.id}})},async onSubmit(t){const e=await B.wW.confirmSuccess("저장하시겠습니까?");e&&this.$http.post("/guestbook",t).then((t=>{const e={...t.data};e.regDate=this.$moment(e.regDate).format("YYYY-MM-DD HH:mm:ss"),this.guestbookList.push(e),this.guestbookList=this.guestbookList.sort(((t,e)=>e.id-t.id)),B.wW.toastSuccess("저장되었습니다.")}))},dataLoading(){0<this.guestbookList.length&&(this.dataLoaded=!0)}}};const bt=(0,J.Z)(gt,[["render",q],["__scopeId","data-v-6f53e900"]]);var mt=bt}}]);
//# sourceMappingURL=29.8c877d29.js.map